import{j as s,r as h,Q as Y,u as O,f as ss,a as es,l as ts}from"./index-840de58d.js";import{b as Q,c as ns,U as q,s as f}from"./FinanceManager-0ca2f058.js";import{U as A,B as V}from"./UserMemberContentWrapper-d4cbea5a.js";import{u as N,c as p}from"./AssestsBaseUrl-3e7ac4b0.js";import{C as H}from"./CreateButton-390a73d1.js";import{M as z}from"./Modal-6a8c66d1.js";import{s as B}from"./Income.module-ac045463.js";import{m as as,A as os,B as rs,L as cs,aj as W,ak as ls}from"./StaffMemberConfig-7a36179e.js";import{C as w}from"./CustomSelectDepartment-370633fe.js";import{s as C,d as G}from"./dayjs.min-1b7b0994.js";import{T as $,a as I}from"./TileCard-9815c4ce.js";import{s as i}from"./StudentStatitics.module-ae8241d4.js";import{l as J}from"./localTime-e3caacba.js";import"./Loading-1f40e573.js";import"./UiTab.module-f6b989ec.js";import"./FormInputView-8f94e437.js";import"./auth-api-76ff487b.js";import"./MethodType-30df8d44.js";import"./checkingRequiredField-382733fa.js";import"./PlateformUser.module-0e3694bb.js";import"./BackdropModal-142f7ac8.js";import"./Utils.module-b6acf444.js";import"./decrypt-c89175fd.js";import"./UserDrawer-bfa56692.js";const K=({fid:t,onSelect:r,onlyDepartment:_})=>{const{t:o}=N(),{instituteAllDepartment:n}=as({fid:t,skip:!t});return s.jsx(s.Fragment,{children:_?s.jsx(w,{selectLabel:o("select_department"),selectedValue:o("select_department_placeholder"),options:(n==null?void 0:n.length)>0?n:[],onClick:r,isFull:!0}):s.jsx(w,{selectLabel:o("select_department"),selectedValue:o("select_department_placeholder"),options:(n==null?void 0:n.length)>0?["ALL","By Bank","Particular Student",...n]:["ALL","By Bank","Particular Student"],onClick:r,isFull:!0})})},X=({did:t,onSelect:r,onlyBatch:_})=>{const{t:o}=N(),{departmentAllBatch:n}=os({did:t,skip:!t});return s.jsx(s.Fragment,{children:_?s.jsx(Q,{selectLabel:o("select_batch"),selectedValue:o("select_batch_placeholder"),options:(n==null?void 0:n.length)>0?n:[],onClick:r,isFull:!0}):s.jsx(Q,{selectLabel:o("select_batch"),selectedValue:o("select_batch_placeholder"),options:(n==null?void 0:n.length)>0?["ALL",...n]:["ALL"],onClick:r,isFull:!0})})},Z=({instituteId:t,did:r,onSelect:_})=>{const{t:o}=N(),{departmentAllClassMaster:n}=rs({data:{id:t,did:r},skip:t?!r:!t});return s.jsx(ns,{selectLabel:o("select_standard"),selectedValue:o("select_standard_placeholder"),options:(n==null?void 0:n.length)>0?[...n]:[],onClick:_,isFull:!0})},_s=({selectLabel:t,onClick:r,selectedValue:_,options:o,customStyleContainer:n,customLabelStyle:d,customListStyle:j,errorShow:m,defalutValue:x,viewAs:b,isFull:u})=>{const{t:T}=N(),[g,k]=h.useState(!1),[L,c]=h.useState(""),U=()=>{k(e=>!e)};h.useEffect(()=>{b==="NORMAL_FILTER"&&c(x)},[b,x]),h.useEffect(()=>{if(b==="CUSTOM_FILTER"){let e="";for(let l of o)for(let R of x)if((l==null?void 0:l._id)===R){let M=(l==null?void 0:l.dName)??(l==null?void 0:l.batchName)??(l==null?void 0:l.className)??"";e=e?e+", "+M:M}c(e)}},[b,x,o]);const a=e=>{r(u?e:e==null?void 0:e._id),U(),c((e==null?void 0:e.finance_bank_account_name)??e)};return s.jsxs("div",{className:C.form_input_container,style:{...n},children:[s.jsxs("p",{className:C.join_form_select_paragraph,style:{...d},children:[t,m&&s.jsxs("span",{style:{color:"red",marginLeft:"15px"},children:["* ",T("form_require_label")]})]}),s.jsxs("section",{className:C.join_form_select_custom,onClick:U,children:[L?s.jsx("p",{className:C.join_form_select_custom_paragraph,children:L??""}):s.jsx("p",{className:C.join_form_select_custom_paragraph,children:_}),g?s.jsx("img",{className:C.join_form_select_custom_rotate_icon,src:`${p}/down.svg`,alt:"categor icon"}):s.jsx("img",{className:C.join_form_select_custom_icon,src:`${p}/down.svg`,alt:"categor icon"})]}),g&&s.jsx(s.Fragment,{children:s.jsx("section",{className:C.join_form_select_custom_list,style:j,children:o==null?void 0:o.map((e,l)=>s.jsx("p",{onClick:()=>a(e),className:C.join_form_select_custom_paragraph_option,children:(e==null?void 0:e.finance_bank_account_name)??e},l))})})]})},F=({fid:t,onSelect:r})=>{var n;const{t:_}=N(),{financeAllBank:o}=cs({data:{fid:t,page:1,limit:1e3,search:""},skip:!t});return s.jsx(_s,{selectLabel:_("bank_account"),selectedValue:_("bank_account_placeholder"),options:((n=o==null?void 0:o.all_accounts)==null?void 0:n.length)>0?[...o==null?void 0:o.all_accounts]:[],onClick:r,isFull:!0})},D=[{key:"ALL_BATCH",name:"all_batches"},{key:"ACTIVE_BATCH",name:"active_batches"}],E=[{key:"ALL",name:"all_departments"},{key:"PARTICULAR",name:"particular_department"}],P=[{key:"ALL_BATCH",name:"all_batches"},{key:"PARTICULAR_BATCH",name:"particular_batch"}],is=({onClose:t,fid:r,instituteId:_})=>{const{t:o}=N(),[n,d]=h.useState({activity_status:"",all_depart:"",batch_status:"",master:[],batch:"",depart:"",bank:"",single_student:""}),[j,m]=h.useState(!1),[x]=W(),b=h.useCallback(a=>{a!=null&&a._id&&d(e=>({...e,all_depart:"PARTICULAR",depart:a==null?void 0:a._id}))},[]),u=h.useCallback(a=>{a!=null&&a._id?d(e=>({...e,batch_status:"PARTICULAR_BATCH",batch:a==null?void 0:a._id})):d(e=>({...e,batch_status:"ALL_BATCH",batch:""}))},[]),T=h.useCallback(a=>{d(e=>({...e,master:[a==null?void 0:a._id]}))},[]),g=h.useCallback(a=>{d(e=>({...e,bank:a==null?void 0:a._id}))},[]),k=()=>{r&&(m(a=>!a),x({fid:r,moduleType:"OVERALL_VIEW",statisticsBody:n}).then(a=>{var e,l;((l=(e=a==null?void 0:a.data)==null?void 0:e.excel_list)==null?void 0:l.length)>0&&t(),m(R=>!R)}).catch({}))},L=a=>{a===n.activity_status?d(e=>({...e,activity_status:"",batch:""})):d(e=>({...e,activity_status:a,batch:""}))},c=a=>{d(e=>({...e,all_depart:a,depart:""}))},U=a=>{d(e=>({...e,batch_status:a,batch:""}))};return s.jsx(z,{onClose:t,children:s.jsxs("div",{className:B.modal_container,children:[s.jsx(A,{children:s.jsxs("div",{className:B.modal_container_outer_header,children:[s.jsx("div",{className:B.modal_container_header,children:s.jsx("h6",{children:o("overall_fee_statistics_filter")})}),s.jsx("img",{src:`${p}/close.svg`,alt:"close icon",onClick:t})]})}),s.jsx(V,{}),s.jsxs(A,{customStyle:{paddingTop:"0"},children:[s.jsx($,{label:"activity_type",children:D==null?void 0:D.map(a=>s.jsx(I,{tile:a,onTile:L,activeTile:n.activity_status},a==null?void 0:a.key))}),n.activity_status?null:s.jsxs(s.Fragment,{children:[s.jsx($,{label:"department_type",children:E==null?void 0:E.map(a=>s.jsx(I,{tile:a,onTile:c,activeTile:n.all_depart},a==null?void 0:a.key))}),n.all_depart==="PARTICULAR"?s.jsxs(s.Fragment,{children:[s.jsx(K,{fid:r,onSelect:b,onlyDepartment:!0}),s.jsx($,{label:"batch_type",children:P==null?void 0:P.map(a=>s.jsx(I,{tile:a,onTile:U,activeTile:n.batch_status},a==null?void 0:a.key))}),n.batch_status==="PARTICULAR_BATCH"?s.jsx(X,{did:n.depart,onSelect:u,onlyBatch:!0}):null,s.jsx(Z,{did:n.depart,onSelect:T,instituteId:_})]}):null,s.jsx(F,{fid:r,onSelect:g})]}),s.jsx(H,{label:"filter",onAction:k})]}),j&&s.jsx(Y,{})]})})},y=({label:t,amount:r,iconUrl:_})=>{const{t:o}=N();return s.jsxs("div",{className:i.osc_card,children:[s.jsx("img",{src:_,alt:"overal icon"}),s.jsxs("div",{className:i.osc_card_inner,children:[s.jsxs("h6",{children:[o("rs")," ",r??0]}),s.jsx("p",{children:o(t)})]})]})},ds=({fnanceOverallFeeStatistics:t})=>{const r=O(),_=ss(),o=es(),n=h.useCallback(()=>{r(`/${_.username}/member/staff/finance?type=fees-statistics&n=admission`,{state:o.state})},[r,_,o.state]);return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:i.osc_container,children:[s.jsx(y,{iconUrl:`${p}/total-collected.svg`,amount:(t==null?void 0:t.total_pending)??0,label:"total_fees_to_be_collected"}),s.jsx(y,{iconUrl:`${p}/total-collection.svg`,amount:(t==null?void 0:t.total_collect)??0,label:"total_collection"}),s.jsx(y,{iconUrl:`${p}/total-fees.svg`,amount:(t==null?void 0:t.total_pending)??0,label:"total_fees"}),s.jsx(y,{iconUrl:`${p}/student-collection.svg`,amount:(t==null?void 0:t.collect_by_student)??0,label:"collection_from_student"}),s.jsx(y,{iconUrl:`${p}/student-pending.svg`,amount:(t==null?void 0:t.pending_by_student)??0,label:"outstanding_from_student"}),s.jsx(y,{iconUrl:`${p}/gov-recieve.svg`,amount:(t==null?void 0:t.collect_by_government)??0,label:"recieved_from_gov"}),s.jsx(y,{iconUrl:`${p}/gov-pending.svg`,amount:(t==null?void 0:t.pending_from_government)??0,label:"outstanding_from_gov"}),s.jsx(y,{iconUrl:`${p}/excess-fee.svg`,amount:(t==null?void 0:t.excess_fees)??0,label:"excess_fees"}),s.jsx(y,{iconUrl:`${p}/total-deposit.svg`,amount:(t==null?void 0:t.total_deposits)??0,label:"total_deposit"}),s.jsx(y,{iconUrl:`${p}/total-income.svg`,amount:(t==null?void 0:t.incomes)??0,label:"total_income"}),s.jsx(y,{iconUrl:`${p}/total-expense.svg`,amount:(t==null?void 0:t.expenses)??0,label:"total_expense"})]}),s.jsx("div",{className:i.osc_container,children:s.jsx(H,{label:"admission_fees_statitics",onAction:n})})]})},ms=({fid:t,instituteId:r})=>{const{t:_}=N(),[o,n]=h.useState(""),[d,j]=h.useState(!1),[m]=W(),{fnanceOverallFeeStatistics:x}=ls({fid:t,skip:!t}),b=h.useCallback(()=>{n("")},[]),u=()=>{n("FILTER")},T=()=>{t&&(j(g=>!g),m({fid:t,moduleType:"OVERALL_VIEW"}).then(()=>{j(g=>!g)}).catch({}))};return s.jsxs(s.Fragment,{children:[s.jsxs(q,{children:[s.jsx(A,{children:s.jsx("div",{className:f.fm_header_container,children:s.jsx("h6",{children:_("overall_fees_statitics")})})}),s.jsx(V,{}),s.jsxs(A,{customStyle:{paddingTop:"0.2rem"},children:[s.jsxs("div",{className:f.fm_fs_container,children:[s.jsxs("h6",{className:f.fm_title_heading,style:{flex:"2 2"},children:[_("apply_filter")," "," : "]}),s.jsxs("div",{className:f.fm_fs_container_inner,style:{flex:"1 1"},children:[s.jsx(H,{label:"filter",onAction:u,customStyle:{margin:"0"}}),s.jsxs("div",{className:f.fm_fs_refetch_container,onClick:T,children:[m!=null&&m.loading_status?s.jsx("img",{src:`${p}/refresh-rotate.gif`,alt:"refetch icon"}):s.jsx("img",{src:`${p}/refresh.svg`,alt:"refetch icon"}),s.jsxs("div",{className:f.fm_fs_refetch_container_inner,children:[s.jsx("h6",{children:_("refetch_data")}),s.jsxs("p",{children:[_("last_updated")," : ",G(x==null?void 0:x.last_update).format("DD MMM YYYY"),", ",J(x==null?void 0:x.last_update,"LT")]})]})]})]})]}),s.jsx(ds,{fnanceOverallFeeStatistics:x})]})]}),o==="FILTER"?s.jsx(is,{onClose:b,fid:t,instituteId:r}):null,d&&s.jsx(Y,{})]})},hs=({statitics:t})=>{var _;const{t:r}=N();return s.jsx("div",{className:i.ss_table,children:s.jsxs("div",{className:i.fs_table_header,children:[s.jsx("div",{className:i.fs_table_col,style:{borderRight:"none"},children:S==null?void 0:S.map(o=>s.jsx("div",{className:i.fs_table_header_inner,children:s.jsx("h6",{className:i.fs_table_header_inner_h6,style:{width:"10rem"},children:r(o==null?void 0:o.name)})},o==null?void 0:o.name))}),(_=t==null?void 0:t.departs)==null?void 0:_.map((o,n)=>{var d,j;return s.jsxs("div",{className:i.fs_table_col,children:[s.jsx("div",{className:i.fs_table_header_inner,children:s.jsx("h6",{className:i.fs_table_header_inner_h6,children:o[`dp${n+1}`]})}),s.jsx("div",{className:i.fs_table_col_inner,children:(j=(d=t[`dp${n+1}`])==null?void 0:d.batches)==null?void 0:j.map(m=>{var x,b;return s.jsxs("div",{children:[s.jsx("div",{className:i.fs_table_header_inner,children:s.jsx("h6",{className:i.fs_table_header_inner_h6,children:m==null?void 0:m.batchName})}),s.jsx("div",{className:i.fs_table_col_inner,style:{alignItems:"flex-start"},children:(b=(x=t[`dp${n+1}`])==null?void 0:x.masters)==null?void 0:b.map(u=>{var T,g,k,L;return s.jsxs("div",{children:[s.jsx("div",{className:i.fs_table_header_inner,children:s.jsx("h6",{className:i.fs_table_header_inner_h6,style:{width:"10rem"},children:(u==null?void 0:u.masterName)??"NULL"})},u==null?void 0:u._id),s.jsx("div",{className:i.fs_table_col_inner,children:(L=(k=(g=xs((T=t[`dp${n+1}`])==null?void 0:T.nest_classes,m==null?void 0:m._id))==null?void 0:g[m==null?void 0:m._id])==null?void 0:k.classes)==null?void 0:L.map(c=>(c==null?void 0:c.classMaster)===(u==null?void 0:u._id)?s.jsxs("div",{children:[s.jsx("div",{className:i.fs_table_header_inner,children:s.jsx("h6",{className:i.fs_table_header_inner_h6,style:{width:"10rem"},children:(c==null?void 0:c.className)??"NULL"})}),s.jsx("div",{className:i.fs_table_header_inner,children:s.jsx("h6",{className:i.fs_table_header_inner_h6,children:(c==null?void 0:c.total_fees)??"NULL"})}),s.jsx("div",{className:i.fs_table_header_inner,children:s.jsx("h6",{className:i.fs_table_header_inner_h6,children:(c==null?void 0:c.total_collect)??"NULL"})}),s.jsx("div",{className:i.fs_table_header_inner,children:s.jsx("h6",{className:i.fs_table_header_inner_h6,children:(c==null?void 0:c.total_pending)??"NULL"})}),s.jsx("div",{className:i.fs_table_header_inner,children:s.jsx("h6",{className:i.fs_table_header_inner_h6,children:(c==null?void 0:c.collect_by_student)??"NULL"})}),s.jsx("div",{className:i.fs_table_header_inner,children:s.jsx("h6",{className:i.fs_table_header_inner_h6,children:(c==null?void 0:c.pending_by_student)??"NULL"})}),s.jsx("div",{className:i.fs_table_header_inner,children:s.jsx("h6",{className:i.fs_table_header_inner_h6,children:(c==null?void 0:c.collect_by_government)??"NULL"})}),s.jsx("div",{className:i.fs_table_header_inner,children:s.jsx("h6",{className:i.fs_table_header_inner_h6,children:(c==null?void 0:c.pending_from_government)??"NULL"})})]},c==null?void 0:c._id):null)})]})})})]},m==null?void 0:m._id)})})]},n)})]})})},S=[{name:"department"},{name:"batch"},{name:"standard"},{name:"class"},{name:"total_fees"},{name:"total_collect"},{name:"total_pending"},{name:"collect_by_student"},{name:"pending_by_student"},{name:"collect_by_gov"},{name:"pending_by_gov"}],xs=(t,r)=>{for(let _ of t)for(let o in _)if(o===r)return _},js=({onClose:t,fid:r,instituteId:_,setStatitics:o})=>{const{t:n}=N(),[d,j]=h.useState({activity_status:"",all_depart:"",batch_status:"",master:[],batch:"",depart:"",bank:"",single_student:""}),[m,x]=h.useState(!1),[b]=W(),u=h.useCallback(e=>{e!=null&&e._id&&j(l=>({...l,all_depart:"PARTICULAR",depart:e==null?void 0:e._id}))},[]),T=h.useCallback(e=>{e!=null&&e._id?j(l=>({...l,batch_status:"PARTICULAR_BATCH",batch:e==null?void 0:e._id})):j(l=>({...l,batch_status:"ALL_BATCH",batch:""}))},[]),g=h.useCallback(e=>{j(l=>({...l,master:[e==null?void 0:e._id]}))},[]),k=h.useCallback(e=>{j(l=>({...l,bank:e==null?void 0:e._id}))},[]),L=()=>{r&&(x(e=>!e),b({fid:r,moduleType:"ADMISSION_VIEW",statisticsBody:d}).then(e=>{var l,R,M;((R=(l=e==null?void 0:e.data)==null?void 0:l.excel_list)==null?void 0:R.length)>0&&(o((M=e==null?void 0:e.data)==null?void 0:M.excel_list),t()),x(v=>!v)}).catch({}))},c=e=>{e===d.activity_status?j(l=>({...l,activity_status:"",batch:""})):j(l=>({...l,activity_status:e,batch:""}))},U=e=>{j(l=>({...l,all_depart:e,depart:""}))},a=e=>{j(l=>({...l,batch_status:e,batch:""}))};return s.jsx(z,{onClose:t,children:s.jsxs("div",{className:B.modal_container,children:[s.jsx(A,{children:s.jsxs("div",{className:B.modal_container_outer_header,children:[s.jsx("div",{className:B.modal_container_header,children:s.jsx("h6",{children:n("admission_fee_statistics_filter")})}),s.jsx("img",{src:`${p}/close.svg`,alt:"close icon",onClick:t})]})}),s.jsx(V,{}),s.jsxs(A,{customStyle:{paddingTop:"0"},children:[s.jsx($,{label:"activity_type",children:D==null?void 0:D.map(e=>s.jsx(I,{tile:e,onTile:c,activeTile:d.activity_status},e==null?void 0:e.key))}),d.activity_status?null:s.jsxs(s.Fragment,{children:[s.jsx($,{label:"department_type",children:E==null?void 0:E.map(e=>s.jsx(I,{tile:e,onTile:U,activeTile:d.all_depart},e==null?void 0:e.key))}),d.all_depart==="PARTICULAR"?s.jsxs(s.Fragment,{children:[s.jsx(K,{fid:r,onSelect:u,onlyDepartment:!0}),s.jsx($,{label:"batch_type",children:P==null?void 0:P.map(e=>s.jsx(I,{tile:e,onTile:a,activeTile:d.batch_status},e==null?void 0:e.key))}),d.batch_status==="PARTICULAR_BATCH"?s.jsx(X,{did:d.depart,onSelect:T,onlyBatch:!0}):null,s.jsx(Z,{did:d.depart,onSelect:g,instituteId:_})]}):null,s.jsx(F,{fid:r,onSelect:k})]}),s.jsx(H,{label:"filter",onAction:L})]}),m&&s.jsx(Y,{})]})})},ps=({fid:t,instituteId:r})=>{const{t:_}=N(),[o,n]=h.useState(""),[d,j]=h.useState([]),m=h.useCallback(()=>{n("")},[]),x=()=>{n("FILTER")};return s.jsxs(s.Fragment,{children:[s.jsxs(q,{children:[s.jsx(A,{children:s.jsx("div",{className:f.fm_header_container,children:s.jsx("h6",{children:_("admission_fees_statitics")})})}),s.jsx(V,{}),s.jsxs(A,{customStyle:{paddingTop:"0.2rem"},children:[s.jsxs("div",{className:f.fm_fs_container,children:[s.jsxs("h6",{className:f.fm_title_heading,style:{flex:"2 2"},children:[_("apply_filter")," "," : "]}),s.jsxs("div",{className:f.fm_fs_container_inner,style:{flex:"1 1"},children:[s.jsx(H,{label:"filter",onAction:x,customStyle:{margin:"0"}}),s.jsxs("div",{className:f.fm_fs_refetch_container,children:[s.jsx("img",{src:`${p}/refresh.svg`,alt:"refetch icon"}),s.jsxs("div",{className:f.fm_fs_refetch_container_inner,children:[s.jsx("h6",{children:_("refetch_data")}),s.jsxs("p",{children:[_("last_updated")," : ",G().format("DD MMM YYYY"),", ",J("LT")]})]})]})]})]}),(d==null?void 0:d[0])&&s.jsx(hs,{statitics:d==null?void 0:d[0]})]})]}),o==="FILTER"?s.jsx(js,{onClose:m,fid:t,instituteId:r,setStatitics:j}):null]})},Ws=({fid:t,instituteId:r})=>{const[_]=ts();return _.get("n")==="admission"?s.jsx(ps,{instituteId:r,fid:t}):s.jsx(ms,{instituteId:r,fid:t})};export{Ws as default};
