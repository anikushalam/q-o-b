import{r as h,j as e,Q as E}from"./index-840de58d.js";import{U as D,s as b}from"./FinanceManager-0ca2f058.js";import{T as V,U as P,V as q,a as R,W as Q,n as w,j as H}from"./StaffMemberConfig-7a36179e.js";import{U as S,B as $}from"./UserMemberContentWrapper-d4cbea5a.js";import{u as y,c as O,f as L}from"./AssestsBaseUrl-3e7ac4b0.js";import{s as n}from"./Income.module-ac045463.js";import{d as W,F as z}from"./dayjs.min-1b7b0994.js";import{M as Y}from"./Modal-6a8c66d1.js";import{F as I}from"./FormInputView-8f94e437.js";import{F as G}from"./FormFileView-dd40507c.js";import{A as J}from"./AddButton-399e6ce7.js";import{F as K}from"./FormFile-42079381.js";import{T as X,a as Z}from"./TileCard-9815c4ce.js";import{F as ee,P as se}from"./PlateformUser-522dec6f.js";import{F as re}from"./FormTextarea-b8631928.js";import{C as te}from"./CreateButton-390a73d1.js";import{r as oe,e as ae}from"./checkingRequiredField-382733fa.js";import{t as ne}from"./transaction_constant-ad8d613b.js";import{L as ce}from"./Loading-1f40e573.js";import"./UiTab.module-f6b989ec.js";import"./auth-api-76ff487b.js";import"./MethodType-30df8d44.js";import"./PlateformUser.module-0e3694bb.js";import"./decrypt-c89175fd.js";import"./UserDrawer-bfa56692.js";import"./BackdropModal-142f7ac8.js";import"./Utils.module-b6acf444.js";const le=({fid:r})=>{var s,i,d,p;const{t:c}=y(),{financeIncomeBalance:t}=V({fid:r,skip:!r});return e.jsxs("div",{className:n.right,children:[e.jsxs("div",{className:n.rightHead,style:{"--bg-expense-color":"#20b038"},children:[e.jsx("h6",{children:c("total_income")}),e.jsxs("h6",{children:[c("rs"),((s=t==null?void 0:t.incomeBalance)==null?void 0:s.financeIncomeCashBalance)+((i=t==null?void 0:t.incomeBalance)==null?void 0:i.financeIncomeBankBalance)]})]}),e.jsxs("div",{className:n.rightBody,children:[e.jsxs("h6",{children:[" ",c("by_cash")," : ",c("rs"),(d=t==null?void 0:t.incomeBalance)==null?void 0:d.financeIncomeCashBalance]}),e.jsxs("h6",{children:[" ",c("by_bank")," : ",c("rs"),(p=t==null?void 0:t.incomeBalance)==null?void 0:p.financeIncomeBankBalance]})]})]})},me=h.memo(le),B=({income:r,setIncomeId:c})=>{var i;const{t}=y(),s=()=>{c(r==null?void 0:r._id)};return e.jsxs("div",{onClick:s,className:n.card_container,children:[e.jsxs("h6",{className:n.invoice_number,children:[t("invoice_no")," "," : "," ",r==null?void 0:r.invoice_number]}),e.jsxs("div",{className:n.sidebarheader,children:[e.jsxs("div",{className:n.text,children:[e.jsx("p",{className:n.rcv,children:t("recived_from")}),e.jsx("h6",{children:r!=null&&r.incomeFrom?r==null?void 0:r.incomeFrom:(i=r==null?void 0:r.incomeFromUser)==null?void 0:i.userLegalName}),e.jsx("p",{className:n.rcv,children:W(r==null?void 0:r.createdAt).format("MMMM D, YYYY")})]}),e.jsxs("div",{className:n.text,children:[e.jsx("p",{className:n.rcv1}),e.jsxs("h6",{children:[t("rs")," ",r==null?void 0:r.incomeAmount]}),e.jsx("p",{className:n.rcv,children:r==null?void 0:r.incomeAccount})]})]})]})},ie=({onClose:r,incomeId:c})=>{var i,d,p,g,x,_,j,u,F,v;const{t}=y(),{financeIncomeDetail:s}=P({incomeId:c,skip:!c});return e.jsx(Y,{onClose:r,children:e.jsxs("div",{className:n.income_detail,children:[e.jsxs("div",{className:n.detailTop,children:[e.jsx("div",{className:n.detailTopMid,children:e.jsx("h6",{children:(i=s==null?void 0:s.oneIncome)!=null&&i.incomeFrom?(d=s==null?void 0:s.oneIncome)==null?void 0:d.incomeFrom:(g=(p=s==null?void 0:s.oneIncome)==null?void 0:p.incomeFromUser)==null?void 0:g.userLegalName})}),e.jsx("div",{className:n.detailTopMid,children:e.jsxs("h6",{children:["Rs. ",(x=s==null?void 0:s.oneIncome)==null?void 0:x.incomeAmount]})})]}),e.jsxs(S,{children:[e.jsx(I,{label:`${t("transaction_mode")}: `,value:(_=s==null?void 0:s.oneIncome)==null?void 0:_.incomeAccount,customFormInput:{fontWeight:"500"}}),e.jsx(I,{label:`${t("description")}: `,value:(j=s==null?void 0:s.oneIncome)==null?void 0:j.incomeDesc,customFormInput:{fontWeight:"500"}}),e.jsx(I,{label:`${t("day_date")}: `,value:W((u=s==null?void 0:s.oneIncome)==null?void 0:u.createdAt).format("MMMM D, YYYY"),customFormInput:{fontWeight:"500"}}),(F=financeExpenseDetail==null?void 0:financeExpenseDetail.oneIncome)!=null&&F.incomeAck?e.jsx(G,{label:`${t("acknowlegement")}: `,value:{key:(v=s==null?void 0:s.oneIncome)==null?void 0:v.incomeAck},customFormInput:{fontWeight:"500"}}):null]})]})})},de=({onClose:r,fid:c})=>{var a;const{t}=y(),[s,i]=h.useState({incomeAmount:"",incomeFrom:"",incomeDesc:"",incomeAccount:"By Bank"}),[d,p]=h.useState(""),[g,x]=h.useState(!1),[_,j]=h.useState(!1),[u,F]=h.useState(""),[v,l]=h.useState(""),[U]=q(),A=o=>{o.target.name==="incomeAmount"?i(m=>({...m,[o.target.name]:o.target.value})):i(m=>({...m,[o.target.name]:o.target.value}))},T=o=>{i(m=>({...m,incomeAccount:o}))},M=o=>{p(o.target.files[0])},C=()=>{let o=oe(s,["incomeDesc"]);if(ae(o)){if(c){x(f=>!f);const m=new FormData;m.append("incomeAmount",s.incomeAmount),u||m.append("incomeFrom",s.incomeFrom),m.append("incomeDesc",s.incomeDesc),m.append("incomeAccount",s.incomeAccount),m.append("file",d),U({fData:m,fid:c,user_query:u}).then(()=>{x(f=>!f),r()}).catch(()=>{x(f=>!f)})}}else l(o)},k=o=>{F(o==null?void 0:o._id),j(!1),i(m=>({...m,incomeFrom:o==null?void 0:o.userLegalName}))},N=()=>{j(o=>!o)};return e.jsx(e.Fragment,{children:_?e.jsx(se,{onSelectUser:k,selectedId:u,onClose:N}):e.jsx(Y,{onClose:r,children:e.jsxs("div",{className:n.modal_container,children:[e.jsx(S,{children:e.jsxs("div",{className:n.modal_container_outer_header,children:[e.jsx("div",{className:n.modal_container_header,children:e.jsx("h6",{children:t("add_income_receipt")})}),e.jsx("img",{src:`${O}/close.svg`,alt:"close icon",onClick:r})]})}),e.jsx($,{}),e.jsxs(S,{customStyle:{paddingTop:"0"},children:[e.jsx(X,{label:"select_transaction_mode",children:(a=ne)==null?void 0:a.map(o=>e.jsx(Z,{tile:o,onTile:T,activeTile:s.incomeAccount},o==null?void 0:o.key))}),e.jsx(z,{label:t("amount"),placeholder:t("amount_placeholder"),name:"incomeAmount",value:s.incomeAmount,type:"text",onChange:A,errorShow:v.incomeAmount}),e.jsx(ee,{label:t("from"),placeholder:t("from_placeholder"),name:"incomeFrom",value:s.incomeFrom,type:"text",onChange:A,errorShow:v.incomeFrom,iconUrl:`${L}/navbar-search.svg`,searchLabel:"search_and_select",onSearchAction:N}),e.jsx(re,{label:t("description"),placeholder:t("description_placeholder"),name:"incomeDesc",value:s.incomeDesc,type:"text",onChange:A,errorShow:v.incomeDesc}),e.jsx(K,{label:t("acknowlegement_receipt"),name:"acknowlegement_receipt",value:d!=null&&d.name?{name:d==null?void 0:d.name}:"",onChange:M}),e.jsx(te,{label:"save_receipt",onAction:C})]}),g&&e.jsx(E,{})]})})})},Ee=({fid:r})=>{var k,N;const{t:c}=y(),[t,s]=h.useState(""),[i,d]=h.useState(1),[p,g]=h.useState(!0),[x,_]=R({skip:t}),[j,u]=h.useState(""),[F,v]=h.useState(!1),{financeIncome:l,financeIncomeLoading:U}=Q({data:{fid:r,page:i,limit:10,search:t},skip:!r});h.useEffect(()=>{_&&p&&d(a=>a+1)},[_,p]),h.useEffect(()=>{var a;(a=l==null?void 0:l.allIncome)!=null&&a.length&&w(l==null?void 0:l.length,g)},[(k=l==null?void 0:l.allIncome)==null?void 0:k.length,w]);const A=h.useCallback(H(a=>s(a),500),[]),T=a=>{A(a.target.value)},M=()=>{u("")},C=()=>{v(a=>!a)};return e.jsxs(e.Fragment,{children:[e.jsxs(D,{children:[e.jsx(S,{children:e.jsxs("div",{className:b.fm_header_container,children:[e.jsx("h6",{children:c("income_history")}),e.jsx("div",{className:b.fm_search,children:e.jsx("section",{className:b.fm_search_container,children:e.jsxs("div",{className:b.fm_search_container_inner,children:[e.jsx("img",{className:b.fm_search_icon,alt:"search icon",src:`${L}/navbar-search.svg`}),e.jsx("input",{type:"text",placeholder:c("search"),onChange:T})]})})})]})}),e.jsx($,{}),e.jsxs(S,{customStyle:{paddingTop:"0.2rem"},children:[e.jsxs("div",{className:b.fm_add_button,children:[e.jsx(me,{fid:r}),e.jsx(J,{label:"add_new_income",onAction:C})]}),U&&e.jsx(ce,{}),(N=l==null?void 0:l.allIncome)==null?void 0:N.map((a,o)=>{var m;return((m=l==null?void 0:l.allIncome)==null?void 0:m.length)===o+1?e.jsx("div",{ref:x,children:e.jsx(B,{income:a,setIncomeId:u})},a==null?void 0:a._id):e.jsx(B,{income:a,setIncomeId:u},a==null?void 0:a._id)})]})]}),j&&e.jsx(ie,{onClose:M,incomeId:j}),F&&e.jsx(de,{onClose:C,fid:r})]})};export{Ee as default};
