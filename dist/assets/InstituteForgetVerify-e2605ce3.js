import{u as N,a as T,r as c,j as r}from"./index-a832c91d.js";import{G as A,s as f}from"./GetStarted-a46d4f1e.js";import{A as U}from"./AuthCardWrapper-1a5695d9.js";import{B as w,N as I}from"./NotifyEvent-b529ab29.js";import{A as q}from"./AuthFormFieldWithIcon-7a3c3e8c.js";import{r as E,e as R}from"./checkingRequiredField-382733fa.js";import{d as $,c as H}from"./auth-api-7a754eeb.js";import{u as W,a as k}from"./AssestsBaseUrl-de8d9127.js";import{O as z}from"./OtpResendTimer-89bc4163.js";import{d as h}from"./decrypt-68b9db7c.js";import"./CreateButton-84994172.js";import"./Utils.module-b6acf444.js";import"./MethodType-30df8d44.js";const et=()=>{const{t:d}=W(),v=N(),o=T(),[p,g]=c.useState({userOtpCode:""}),[B,m]=c.useState(!1),[b,_]=c.useState(""),[x,n]=c.useState({open:!1,msg:"",variant:"error"}),[S]=$(),[j]=H(),F=u=>{g(i=>({...i,userOtpCode:u.target.value}))},O=u=>{var a,s;u.preventDefault();let i=E(p);R(i)&&((a=o.state)!=null&&a.uid)?(m(e=>!e),S({uid:(s=o.state)==null?void 0:s.uid,otp:p}).then(e=>{var l;let t=h((l=e==null?void 0:e.data)==null?void 0:l.encrypt);t!=null&&t.institute?v("/institute/forget/password",{state:{uid:t==null?void 0:t.institute}}):n({msg:"Invalid Otp",open:!0,variant:"error"}),m(C=>!C)}).catch(e=>{n({msg:`Time out of request with reason ${e}`,open:!0,variant:"error"}),m(t=>!t)})):_(i)},y=()=>{var u,i;(u=o==null?void 0:o.state)!=null&&u.phoneNumber&&j({forgot:{username:(i=o==null?void 0:o.state)==null?void 0:i.phoneNumber}}).then(a=>{var e,t;let s=h((e=a==null?void 0:a.data)==null?void 0:e.encrypt);(t=s==null?void 0:s.institute)!=null&&t._id?n({open:!0,msg:"Code will be resent on mobile number",variant:"success"}):n({msg:"Invalid username",open:!0,variant:"error"}),m(l=>!l)}).catch(a=>{n({msg:`Time out of request with reason ${a}`,open:!0,variant:"error"}),m(s=>!s)})};return r.jsx(A,{children:r.jsx(U,{title:"forget_password_verification_code",subTitle:`${d("verification_code_note")} mobile number`,subTitleStyle:{fontSize:"0.7rem"},titleStyle:{fontSize:"1rem"},children:r.jsxs("form",{onSubmit:O,className:f.auth_login_form,children:[r.jsx(q,{placeholder:d("verification_code"),fieldIconUrl:`${k}/auth-otp.svg`,maxLength:"4",validate:b.userOtpCode,name:"userOtpCode",value:p.userOtpCode,onChange:F}),r.jsx("div",{className:f.auth_footer_container,children:r.jsxs("p",{className:f.auth_otp_text,children:[d("if_you_did_not_recieve_otp"),r.jsx(z,{onOtpResend:y})]})}),r.jsx(w,{type:"submit",buttonText:d("verify")}),r.jsx(I,{eventState:x,eventStateHandler:n})]})})})};export{et as default};
