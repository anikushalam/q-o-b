import{j as e,r as o,Q as M}from"./index-840de58d.js";import{c as D,u as B,f as Q}from"./AssestsBaseUrl-3e7ac4b0.js";import{B as w,U as F}from"./UserMemberContentWrapper-d4cbea5a.js";import{A as O}from"./AddButton-399e6ce7.js";import{U as X,s as A,A as Y}from"./FinanceManager-0ca2f058.js";import{a as z,af as Z,n as G,j as H,ag as L,ah as I}from"./StaffMemberConfig-7a36179e.js";import{C as ee}from"./CreateButton-390a73d1.js";import{F as V}from"./dayjs.min-1b7b0994.js";import{M as J}from"./Modal-6a8c66d1.js";import{S as se}from"./SelectDepartment-3172bd08.js";import{s as U}from"./Income.module-ac045463.js";import{r as te,e as ne}from"./checkingRequiredField-382733fa.js";import{s as j}from"./PlateformUser.module-0e3694bb.js";import{L as K}from"./Loading-1f40e573.js";import"./UiTab.module-f6b989ec.js";import"./FormInputView-8f94e437.js";import"./auth-api-76ff487b.js";import"./MethodType-30df8d44.js";import"./decrypt-c89175fd.js";import"./UserDrawer-bfa56692.js";import"./BackdropModal-142f7ac8.js";import"./Utils.module-b6acf444.js";const W=({cls:n,onSelect:d,selectedId:c})=>{const f=()=>{d(n)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:c!=null&&c.includes(n==null?void 0:n._id)?`${j.assign_show_list_each} ${j.assign_show_list_each_active}`:j.assign_show_list_each,onClick:f,children:[e.jsx("img",{src:`${D}/class.svg`,alt:"class icon",style:{borderRadius:"0"}}),e.jsx("div",{className:j.assign_each_paragraph,children:e.jsx("h6",{children:(n==null?void 0:n.className)??""})})]}),e.jsx(w,{customStyleBorder:{margin:"0"}})]})},oe=({onClose:n,did:d,bid:c,onSave:f,clsListId:m,setClsListId:g})=>{const{t:p}=B(),[N,y]=o.useState(""),[C,v]=o.useState(1),[l,a]=o.useState(!0),[$,E]=z({skip:N}),[S,x]=o.useState(m??[]),[r,b]=o.useState([]),{departmentBatchAllClassMaster:i,departmentBatchAllClassMasterLoading:T}=Z({data:{did:d,bid:c,page:C,limit:10,search:N},skip:d?!d:!c});o.useEffect(()=>{m!=null&&m.length&&x(m)},[m==null?void 0:m.length]),o.useEffect(()=>{E&&l&&v(s=>s+1)},[E,l]),o.useEffect(()=>{i!=null&&i.length&&G(i==null?void 0:i.length,a)},[i==null?void 0:i.length]);const k=o.useCallback(H(s=>y(s),500),[]),R=s=>{k(s.target.value)},h=s=>{S!=null&&S.includes(s==null?void 0:s._id)?(x(t=>t==null?void 0:t.filter(u=>u!==(s==null?void 0:s._id))),g(t=>t==null?void 0:t.filter(u=>u!==(s==null?void 0:s._id))),b(t=>t==null?void 0:t.filter(u=>(u==null?void 0:u._id)!==(s==null?void 0:s._id)))):(x(t=>[...t,s==null?void 0:s._id]),g(t=>[...t,s==null?void 0:s._id]),b(t=>[...t,s]))},_=()=>{let s=[];for(let t of r)for(let u of t==null?void 0:t.classDivision)s.push(u==null?void 0:u._id);f(s)};return e.jsx(J,{onClose:n,children:e.jsxs("div",{className:j.modal_container,children:[e.jsx(F,{children:e.jsxs("div",{className:j.modal_container_outer_header,children:[e.jsx("div",{className:j.modal_container_header,children:e.jsx("h6",{children:p("select_standard")})}),e.jsxs("div",{className:j.modal_container_header_btn,children:[e.jsx(O,{label:"select",onAction:_}),e.jsx("img",{src:`${D}/close.svg`,alt:"close icon",onClick:n})]})]})}),e.jsx(w,{}),e.jsxs(F,{customStyle:{paddingTop:"0",paddingBottom:"1rem"},children:[e.jsxs("div",{className:j.assign_search_container,style:{marginBottom:"0.8rem"},children:[e.jsx("input",{type:"text",placeholder:p("search"),className:j.assign_search_input,onChange:R}),e.jsx("img",{src:`${Q}/navbar-search.svg`,alt:"search icon"})]}),T&&e.jsx(K,{}),i==null?void 0:i.map((s,t)=>(i==null?void 0:i.length)===t+1?e.jsx("div",{ref:$,children:e.jsx(W,{cls:s,selectedId:S,onSelect:h})},s==null?void 0:s._id):e.jsx(W,{cls:s,selectedId:S,onSelect:h},s==null?void 0:s._id))]})]})})},re=({fid:n,onClose:d})=>{const{t:c}=B(),[f,m]=o.useState("DEPARTMENT"),[g,p]=o.useState({feeName:"",feeAmount:"",feeDate:""}),[N,y]=o.useState(""),[C,v]=o.useState(!1),[l,a]=o.useState(""),[$]=L(),[E,S]=o.useState([]),[x,r]=o.useState([]),b=h=>{h.target.name==="feeAmount"?p(_=>({..._,feeAmount:+h.target.value})):p(_=>({..._,[h.target.name]:h.target.value}))},i=()=>{if(n&&(x==null?void 0:x.length)>0){let _=new Date().toISOString(),s=`${_==null?void 0:_.substring(0,4)}-${_==null?void 0:_.substring(5,7)}-${_==null?void 0:_.substring(8,10)}`;v(t=>!t),$({fid:n,inernalBody:{did:l==null?void 0:l._id,ClassId:x,feeName:g.feeName,feeAmount:g.feeAmount,feeDate:s}}).then(()=>{v(t=>!t),d()}).catch(()=>{v(t=>!t)})}},T=()=>{let h=te(g,["feeDate"]);ne(h)?i():y(h)},k=h=>{a(h),m("CLASSES")},R=h=>{r(h),m("")};return e.jsx(e.Fragment,{children:f?f==="DEPARTMENT"?e.jsx(se,{onClose:d,fid:n,onSelect:k}):e.jsx(oe,{onClose:()=>m("DEPARTMENT"),did:l==null?void 0:l._id,bid:l==null?void 0:l.departmentSelectBatch,onSave:R,clsListId:E,setClsListId:S}):e.jsx(J,{onClose:d,children:e.jsxs("div",{className:U.modal_container,children:[e.jsx(F,{children:e.jsxs("div",{className:U.modal_container_outer_header,children:[e.jsx("div",{className:U.modal_container_header,children:e.jsx("h6",{children:c("create_new_fees")})}),e.jsx("img",{src:`${D}/close.svg`,alt:"close icon",onClick:()=>m("CLASSES")})]})}),e.jsx(w,{}),e.jsxs(F,{customStyle:{paddingTop:"0"},children:[e.jsx(V,{label:c("fees_name"),placeholder:c("fees_name_placeholder"),name:"feeName",value:g.feeName,type:"text",onChange:b,errorShow:N.feeName}),e.jsx(V,{label:c("amount"),placeholder:c("amount_placeholder"),name:"feeAmount",value:g.feeAmount,type:"text",onChange:b,errorShow:N.feeAmount}),e.jsx(ee,{label:"save",onAction:T})]}),C&&e.jsx(M,{})]})})})},ae="_exam_card_container_lx6x4_1",ie="_exam_inner_text_lx6x4_22",ce="_fees_image_lx6x4_43",P={exam_card_container:ae,exam_inner_text:ie,fees_image:ce},q=({fees:n})=>e.jsxs("div",{className:P.exam_card_container,children:[e.jsx("img",{src:`${D}/fees-card.svg`,alt:"fees icon",className:P.fees_image}),e.jsxs("div",{className:P.exam_inner_text,children:[e.jsxs("h6",{children:["Rs. ",(n==null?void 0:n.feeAmount)??0,"/-"]}),e.jsxs("p",{children:[(n==null?void 0:n.feeName)??""," "]})]})]}),we=({fid:n})=>{const{t:d}=B(),[c,f]=o.useState(""),[m,g]=o.useState(1),[p,N]=o.useState(!0),[y,C]=o.useState(!1),[v,l]=z({skip:c}),{financeAllInternalFee:a,financeAllInternalFeeLoading:$}=I({data:{fid:n,page:m,limit:10,search:c},skip:!n});o.useEffect(()=>{l&&p&&g(r=>r+1)},[l,p]),o.useEffect(()=>{a!=null&&a.length&&G(a==null?void 0:a.length,N)},[a==null?void 0:a.length]);const E=o.useCallback(H(r=>f(r),500),[]),S=r=>{E(r.target.value)},x=()=>{C(r=>!r)};return e.jsxs(e.Fragment,{children:[e.jsxs(X,{children:[e.jsx(F,{children:e.jsxs("div",{className:A.fm_header_container,children:[e.jsx("h6",{children:d("internal_fees")}),e.jsx("div",{className:A.fm_search,children:e.jsx("section",{className:A.fm_search_container,children:e.jsxs("div",{className:A.fm_search_container_inner,children:[e.jsx("img",{className:A.fm_search_icon,alt:"search icon",src:`${Q}/navbar-search.svg`}),e.jsx("input",{type:"text",placeholder:d("search"),onChange:S})]})})})]})}),e.jsx(w,{}),e.jsxs(F,{customStyle:{paddingTop:"0"},children:[e.jsx(Y,{children:e.jsx(O,{label:"create_new_fees",onAction:x})}),$&&e.jsx(K,{}),a==null?void 0:a.map((r,b)=>(a==null?void 0:a.length)===b+1?e.jsx("div",{ref:v,children:e.jsx(q,{fees:r})},r==null?void 0:r._id):e.jsx(q,{fees:r},r==null?void 0:r._id))]})]}),y&&e.jsx(re,{onClose:x,fid:n})]})};export{we as default};
