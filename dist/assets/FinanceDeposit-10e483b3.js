import{j as e,i as R,r as d,Q as O,l as W,a as Y,f as H}from"./index-0b7f6bad.js";import{u as j,b as K,c as S,f as B}from"./AssestsBaseUrl-b3cf1f1b.js";import{B as F,L}from"./UserMemberProfileWrapper-9593601c.js";import{H as Q,a as V}from"./FormInputView-4c2d301f.js";import{s as k,U as q}from"./FinanceManager-a3d1c044.js";import{U as g}from"./UserMemberContentWrapper-bd4f7483.js";import{u as f,n as P,c as E}from"./StaffMemberConfig-a4319af1.js";import{M as U}from"./Modal-07d3eb1d.js";import{s as C}from"./PlateformUser.module-0e3694bb.js";import{a6 as z,a7 as G,a8 as I,a9 as J}from"./finance-manager-api-60207d3b.js";import{F as X,d as Z}from"./dayjs.min-2c4d82f7.js";import{C as M}from"./CreateButton-31b890b3.js";import{T as D,a as A}from"./TileCard-bbe5b4e2.js";import{t as ee}from"./transaction_constant-ad8d613b.js";import{r as se,e as ne}from"./checkingRequiredField-382733fa.js";import{l as ae}from"./localTime-457a5ccd.js";import"./UiTab.module-f6b989ec.js";import"./auth-api-e4fca9d4.js";import"./MethodType-30df8d44.js";import"./Utils.module-b6acf444.js";import"./decrypt-74cd38a1.js";const te="_applicable_to_btn_1tn1k_1",oe="_unused_container_1tn1k_19",re="_unused_container_text_1tn1k_33",ie="_unused_container_text_inner_1tn1k_38",ce="_modal_container_1tn1k_61",_e="_modal_container_header_1tn1k_70",le="_modal_container_outer_header_1tn1k_82",me="_student_container_1tn1k_89",de="_conainter_main_1tn1k_107",he="_student_container_name_1tn1k_112",xe="_corpus_card_1tn1k_131",pe="_recieve_from_1tn1k_156",c={applicable_to_btn:te,unused_container:oe,unused_container_text:re,unused_container_text_inner:ie,modal_container:ce,modal_container_header:_e,modal_container_outer_header:le,student_container:me,conainter_main:de,student_container_name:he,corpus_card:xe,recieve_from:pe},$=({student:s,onSelect:r})=>{var i;const{t:a}=j(),t=()=>{r(s)};return e.jsxs("section",{className:c.student_container,title:"Refund deposit",onClick:t,children:[e.jsx("img",{src:s!=null&&s.studentProfilePhoto?`${R}/${s==null?void 0:s.studentProfilePhoto}`:`${K}/feed-user-avatar.svg`,alt:"student avatar"}),e.jsxs("div",{className:c.conainter_main,children:[e.jsxs("div",{className:c.student_container_name,children:[e.jsx("h6",{children:`${s==null?void 0:s.studentFirstName} ${s!=null&&s.studentMiddleName?s==null?void 0:s.studentMiddleName:""} ${s==null?void 0:s.studentLastName}`}),e.jsxs("h6",{className:c.student_container_gr,children:[a("rs")," ",(s==null?void 0:s.deposit_pending_amount)??0]})]}),e.jsxs("div",{className:c.student_container_name,children:[e.jsxs("h6",{children:[a("gr_number"),(s==null?void 0:s.studentGRNO)??""," ",", ",((i=s==null?void 0:s.department)==null?void 0:i.dName)??""]}),e.jsx("p",{className:c.student_container_gr,children:a("pending_deposit")})]})]})]})},je=({fmid:s,onClose:r,onSelectRefund:a})=>{const{t}=j(),[i,n]=d.useState(""),[p,x]=d.useState(1),[u,v]=d.useState(!0),[_,y]=f({skip:i}),{financeMasterDepositAll:l,financeMasterDepositAllLoading:b}=z({data:{fmid:s,page:p,limit:10,search:i},skip:!s});d.useEffect(()=>{y&&u&&x(o=>o+1)},[y,u]),d.useEffect(()=>{l!=null&&l.length&&P(l==null?void 0:l.length,v)},[l==null?void 0:l.length]);const m=d.useCallback(E(o=>n(o),500),[]),N=o=>{m(o.target.value)},h=o=>{a(o)};return e.jsx(U,{onClose:r,children:e.jsxs("div",{className:C.modal_container,style:{marginBottom:"1rem"},children:[e.jsx(g,{children:e.jsxs("div",{className:C.modal_container_outer_header,children:[e.jsx("div",{className:C.modal_container_header,children:e.jsx("h6",{children:t("deposit_student_list")})}),e.jsx("img",{src:`${S}/close.svg`,alt:"close icon",onClick:r})]})}),e.jsx(F,{}),e.jsxs(g,{customStyle:{paddingTop:"0"},children:[e.jsxs("div",{className:C.assign_search_container,children:[e.jsx("input",{type:"text",placeholder:t("search"),className:C.assign_search_input,onChange:N}),e.jsx("img",{src:`${B}/navbar-search.svg`,alt:"search icon"})]}),b&&e.jsx(L,{}),l==null?void 0:l.map((o,w)=>(l==null?void 0:l.length)===w+1?e.jsx("div",{ref:_,children:e.jsx($,{student:o,onSelect:h})},o==null?void 0:o._id):e.jsx($,{student:o,onSelect:h},o==null?void 0:o._id))]})]})})},ue=({onClose:s,fmid:r,refundForm:a,onCloseParent:t})=>{var N;const{t:i}=j(),[n,p]=d.useState({amount:"",mode:"",fee_payment_mode:"By Bank",fee_payment_amount:"",transaction_date:"",fee_bank_name:"",fee_bank_holder:"",fee_utr_reference:""}),[x,u]=d.useState(!1),[v,_]=d.useState(""),[y]=G(),l=h=>{p(o=>({...o,amount:+h.target.value,fee_payment_amount:+h.target.value}))},b=h=>{p(o=>({...o,mode:h==="By Bank"?"Online":"Offline",fee_payment_mode:h}))},m=()=>{if(r){let h=se(n,["amount","mode","transaction_date","fee_bank_name","fee_bank_holder","fee_utr_reference"]);ne(h)?(u(o=>!o),y({fmid:r,sid:a==null?void 0:a._id,refundDeposit:n}).then(()=>{t(),u(o=>!o)}).catch({})):_(h)}};return e.jsx(e.Fragment,{children:e.jsx(U,{onClose:s,children:e.jsxs("div",{className:c.modal_container,children:[e.jsx(g,{children:e.jsxs("div",{className:c.modal_container_header,children:[e.jsx("img",{src:`${S}/back-arrow.svg`,onClick:s,title:"Go Back",style:{cursor:"pointer"}}),e.jsx("h6",{children:i("refund_deposit")})]})}),e.jsx(F,{}),e.jsxs(g,{customStyle:{paddingTop:"0"},children:[e.jsxs("div",{className:c.unused_container_text_inner,style:{marginTop:"0.6rem"},children:[e.jsx("h6",{children:i("pending_deposit")}),e.jsxs("h6",{children:[i("rs")," ",(a==null?void 0:a.deposit_pending_amount)??0]})]}),e.jsx(D,{label:"payment_type_mode",customTileContainer:{marginBottom:"1rem"},children:(N=ee)==null?void 0:N.map(h=>e.jsx(A,{tile:h,onTile:b,activeTile:n.fee_payment_mode},h==null?void 0:h.key))}),e.jsx(X,{label:i("amount"),name:"fee_payment_amount",type:"tel",value:n==null?void 0:n.fee_payment_amount,onChange:l,placeholder:i("please_enter_amount_paid"),errorShow:v.fee_payment_amount}),e.jsx(M,{label:"confirm",onAction:m})]}),x&&e.jsx(O,{})]})})})},ge=({onClose:s,fmid:r})=>{const[a,t]=d.useState(""),i=p=>{t(p)},n=()=>{t("")};return a?e.jsx(ue,{onClose:n,onCloseParent:s,refundForm:a,fmid:r}):e.jsx(je,{fmid:r,onClose:s,onSelectRefund:i})},ve=({fmid:s,paidStudentCount:r,depositAmount:a})=>{const{t}=j(),[i,n]=d.useState(!1),p=()=>{n(x=>!x)};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:c.applicable_to_btn,onClick:p,style:{width:"50%",marginTop:"2rem",marginBottom:"1rem",cursor:"pointer"},children:[e.jsxs("div",{children:[t("refund_deposit")," "]}),e.jsx("img",{src:`${S}/forward.svg`,alt:"next step"})]}),e.jsxs("section",{className:c.unused_container,children:[e.jsx("img",{src:`${S}/rupee.svg`,alt:"rupee symobl"}),e.jsxs("div",{className:c.unused_container_text,children:[e.jsxs("div",{className:c.unused_container_text_inner,children:[e.jsx("h6",{children:t("total_deposit")}),e.jsxs("h6",{children:[t("rs")," ",a??0]})]}),e.jsx("div",{className:c.unused_container_text_inner,children:e.jsxs("p",{children:[t("of")," ",r??0," ",t("students")]})})]})]}),i&&e.jsx(ge,{onClose:p,fmid:s})]})},T=({refund:s})=>{var a,t,i;const{t:r}=j();return e.jsxs("div",{className:c.corpus_card,children:[e.jsxs("h6",{style:{textAlign:"center"},children:[r("invoice_number")," "," : "," ",(s==null?void 0:s.invoice_count)??""]}),e.jsx("p",{className:c.recieve_from,children:r("paid_to")}),e.jsxs("div",{className:c.unused_container_text_inner,children:[e.jsx("h6",{children:`${((a=s==null?void 0:s.student)==null?void 0:a.studentFirstName)??""} ${((t=s==null?void 0:s.student)==null?void 0:t.studentMiddleName)??""} ${((i=s==null?void 0:s.student)==null?void 0:i.studentLastName)??""}`}),e.jsxs("h6",{children:[r("rs")," ",(s==null?void 0:s.fee_payment_amount)??0]})]}),e.jsxs("div",{className:c.unused_container_text_inner,children:[e.jsxs("p",{style:{color:"rgba(18, 18, 18, 0.8)"},children:[Z(s==null?void 0:s.created_at).format("DD MMM YYYY"),", ",ae(s==null?void 0:s.created_at,"LT")]}),e.jsx("p",{style:{color:"rgba(18, 18, 18, 0.8)"},children:(s==null?void 0:s.fee_payment_mode)==="Online"?"Bank":"Cash"})]})]})},ye=({fid:s})=>{const{t:r}=j(),[a,t]=d.useState(""),[i,n]=d.useState(1),[p,x]=d.useState(!0),[u,v]=f({skip:a}),{financeAllDepositRefund:_,financeAllDepositRefundLoading:y}=I({data:{fid:s,page:i,limit:10,search:a},skip:!s});d.useEffect(()=>{v&&p&&n(m=>m+1)},[v,p]),d.useEffect(()=>{_!=null&&_.length&&P(_==null?void 0:_.length,x)},[_==null?void 0:_.length]);const l=d.useCallback(E(m=>t(m),500),[]),b=m=>{l(m.target.value)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:k.fm_header_container,style:{marginTop:"0.5rem"},children:[e.jsx("h6",{children:r("refund_history")}),e.jsx("div",{className:k.fm_search,style:{marginBottom:"0.5rem"},children:e.jsx("section",{className:k.fm_search_container,children:e.jsxs("div",{className:k.fm_search_container_inner,children:[e.jsx("img",{className:k.fm_search_icon,alt:"search icon",src:`${B}/navbar-search.svg`}),e.jsx("input",{type:"text",placeholder:r("search"),onChange:b})]})})})]}),y&&e.jsx(L,{}),_==null?void 0:_.map((m,N)=>(_==null?void 0:_.length)===N+1?e.jsx("div",{ref:u,children:e.jsx(T,{refund:m})},m==null?void 0:m._id):e.jsx(T,{refund:m},m==null?void 0:m._id))]})},Ne=({refundAmount:s,refundStudentCount:r,fid:a})=>{const{t}=j();return e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:c.unused_container,children:[e.jsx("img",{src:`${S}/rupee.svg`,alt:"rupee symobl"}),e.jsxs("div",{className:c.unused_container_text,children:[e.jsxs("div",{className:c.unused_container_text_inner,children:[e.jsx("h6",{children:t("total_refunded")}),e.jsxs("h6",{children:[t("rs")," ",s??0]})]}),e.jsx("div",{className:c.unused_container_text_inner,children:e.jsxs("p",{children:[t("of")," ",r??0," ",t("students")]})})]})]}),e.jsx(ye,{fid:a})]})},ke=[{label:"collection",id:"collection",urlKey:""},{label:"refunded",id:"refund",urlKey:"&n=refund"}],qe=({fid:s})=>{const{t:r}=j(),[a]=W(),t=Y(),i=H(),{financeMasterDeposit:n,financeMasterDepositLoading:p}=J({fid:s,skip:!s});return e.jsxs(q,{children:[e.jsx(g,{children:e.jsxs("div",{className:k.fm_header_container,children:[e.jsx("h6",{children:r("deposit")}),e.jsx("img",{src:`${S}/filter.svg`,alt:"filter icon"})]})}),e.jsx(F,{}),e.jsxs(g,{customStyle:{paddingTop:"0"},children:[e.jsx(Q,{children:ke.map(x=>e.jsx(V,{tab:x,isLink:!0,isActive:x.id==="collection"&&!a.get("n")?!0:a.get("n")===x.id,parentState:t.state,url:`/${i.username}/member/staff/finance?type=deposit${x.urlKey}`},x==null?void 0:x.id))}),e.jsx(F,{customStyleBorder:{marginTop:"0"}})]}),e.jsx(g,{customStyle:{paddingTop:"0"},children:a.get("n")==="refund"?e.jsx(Ne,{fid:s,refundAmount:n==null?void 0:n.refund_amount,refundStudentCount:n==null?void 0:n.refund_student_count}):e.jsx(ve,{fmid:n==null?void 0:n._id,depositAmount:n==null?void 0:n.deposit_amount,paidStudentCount:n==null?void 0:n.paid_student_count})})]})};export{qe as default};
