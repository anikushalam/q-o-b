import{j as s,r as x,Q as W,u as O,f as ss,a as es,l as ts}from"./index-40ad8b25.js";import{b as w,c as ns,U as q,s as g}from"./FinanceManager-b4a07d77.js";import{U as A}from"./UserMemberContentWrapper-04d21be5.js";import{B as V}from"./UserMemberProfileWrapper-b0858c1e.js";import{u as L,c as j,h as as}from"./AssestsBaseUrl-2ebdccdb.js";import{C as M}from"./CreateButton-86dcb64a.js";import{M as z}from"./Modal-53e97914.js";import{s as U}from"./Income.module-200dd9e8.js";import{m as os,A as rs,B as cs,L as _s,aj as S,ak as ls}from"./StaffMemberConfig-a8337ee7.js";import{C as Q}from"./CustomSelectDepartment-a2ae37af.js";import{s as k,d as G}from"./dayjs.min-c62bdfdc.js";import{T as R,a as B}from"./TileCard-b19a8a78.js";import{s as _}from"./StudentStatitics.module-ec8d605c.js";import{l as J}from"./localTime-207245a3.js";import"./UiTab.module-f6b989ec.js";import"./FormInputView-945cedfe.js";import"./auth-api-a0a156f1.js";import"./MethodType-30df8d44.js";import"./checkingRequiredField-382733fa.js";import"./PlateformUser.module-0e3694bb.js";import"./Utils.module-b6acf444.js";import"./decrypt-a000b880.js";const K=({fid:t,onSelect:r,onlyDepartment:l})=>{const{t:a}=L(),{instituteAllDepartment:o}=os({fid:t,skip:!t});return s.jsx(s.Fragment,{children:l?s.jsx(Q,{selectLabel:a("select_department"),selectedValue:a("select_department_placeholder"),options:(o==null?void 0:o.length)>0?o:[],onClick:r,isFull:!0}):s.jsx(Q,{selectLabel:a("select_department"),selectedValue:a("select_department_placeholder"),options:(o==null?void 0:o.length)>0?["ALL","By Bank","Particular Student",...o]:["ALL","By Bank","Particular Student"],onClick:r,isFull:!0})})},X=({did:t,onSelect:r,onlyBatch:l})=>{const{t:a}=L(),{departmentAllBatch:o}=rs({did:t,skip:!t});return s.jsx(s.Fragment,{children:l?s.jsx(w,{selectLabel:a("select_batch"),selectedValue:a("select_batch_placeholder"),options:(o==null?void 0:o.length)>0?o:[],onClick:r,isFull:!0}):s.jsx(w,{selectLabel:a("select_batch"),selectedValue:a("select_batch_placeholder"),options:(o==null?void 0:o.length)>0?["ALL",...o]:["ALL"],onClick:r,isFull:!0})})},Z=({instituteId:t,did:r,onSelect:l})=>{const{t:a}=L(),{departmentAllClassMaster:o}=cs({data:{id:t,did:r},skip:t?!r:!t});return s.jsx(ns,{selectLabel:a("select_standard"),selectedValue:a("select_standard_placeholder"),options:(o==null?void 0:o.length)>0?[...o]:[],onClick:l,isFull:!0})},is=({selectLabel:t,onClick:r,selectedValue:l,options:a,customStyleContainer:o,customLabelStyle:i,customListStyle:m,errorShow:h,defalutValue:d,viewAs:b,isFull:p})=>{const{t:T}=L(),[y,N]=x.useState(!1),[f,c]=x.useState(""),C=()=>{N(e=>!e)};x.useEffect(()=>{b==="NORMAL_FILTER"&&c(d)},[b,d]),x.useEffect(()=>{if(b==="CUSTOM_FILTER"){let e="";for(let n of a)for(let H of d)if((n==null?void 0:n._id)===H){let P=(n==null?void 0:n.dName)??(n==null?void 0:n.batchName)??(n==null?void 0:n.className)??"";e=e?e+", "+P:P}c(e)}},[b,d,a]);const E=e=>{r(p?e:e==null?void 0:e._id),C(),c((e==null?void 0:e.finance_bank_account_name)??e)};return s.jsxs("div",{className:k.form_input_container,style:{...o},children:[s.jsxs("p",{className:k.join_form_select_paragraph,style:{...i},children:[t,h&&s.jsxs("span",{style:{color:"red",marginLeft:"15px"},children:["* ",T("form_require_label")]})]}),s.jsxs("section",{className:k.join_form_select_custom,onClick:C,children:[f?s.jsx("p",{className:k.join_form_select_custom_paragraph,children:f??""}):s.jsx("p",{className:k.join_form_select_custom_paragraph,children:l}),y?s.jsx("img",{className:k.join_form_select_custom_rotate_icon,src:`${j}/down.svg`,alt:"categor icon"}):s.jsx("img",{className:k.join_form_select_custom_icon,src:`${j}/down.svg`,alt:"categor icon"})]}),y&&s.jsx(s.Fragment,{children:s.jsx("section",{className:k.join_form_select_custom_list,style:m,children:a==null?void 0:a.map((e,n)=>s.jsx("p",{onClick:()=>E(e),className:k.join_form_select_custom_paragraph_option,children:(e==null?void 0:e.finance_bank_account_name)??e},n))})})]})},F=({fid:t,onSelect:r})=>{var o;const{t:l}=L(),{financeAllBank:a}=_s({data:{fid:t,page:1,limit:1e3,search:""},skip:!t});return s.jsx(is,{selectLabel:l("bank_account"),selectedValue:l("bank_account_placeholder"),options:((o=a==null?void 0:a.all_accounts)==null?void 0:o.length)>0?[...a==null?void 0:a.all_accounts]:[],onClick:r,isFull:!0})},$=[{key:"ALL_BATCH",name:"all_batches"},{key:"ACTIVE_BATCH",name:"active_batches"}],I=[{key:"ALL",name:"all_departments"},{key:"PARTICULAR",name:"particular_department"}],D=[{key:"ALL_BATCH",name:"all_batches"},{key:"PARTICULAR_BATCH",name:"particular_batch"}],ds=({onClose:t,fid:r,instituteId:l,onRefetch:a})=>{const{t:o}=L(),[i,m]=x.useState({activity_status:"",all_depart:"",batch_status:"",master:[],batch:"",depart:"",bank:"",single_student:""}),[h,d]=x.useState(!1),[b]=S(),p=x.useCallback(e=>{e!=null&&e._id&&m(n=>({...n,all_depart:"PARTICULAR",depart:e==null?void 0:e._id}))},[]),T=x.useCallback(e=>{e!=null&&e._id?m(n=>({...n,batch_status:"PARTICULAR_BATCH",batch:e==null?void 0:e._id})):m(n=>({...n,batch_status:"ALL_BATCH",batch:""}))},[]),y=x.useCallback(e=>{m(n=>({...n,master:[e==null?void 0:e._id]}))},[]),N=x.useCallback(e=>{m(n=>({...n,bank:e==null?void 0:e._id}))},[]),f=()=>{r&&(d(e=>!e),b({fid:r,moduleType:"OVERALL_VIEW",statisticsBody:i}).then(()=>{t(),a&&a(),d(e=>!e)}).catch({}))},c=e=>{e===i.activity_status?m(n=>({...n,activity_status:"",batch:""})):m(n=>({...n,activity_status:e,batch:""}))},C=e=>{m(n=>({...n,all_depart:e,depart:""}))},E=e=>{m(n=>({...n,batch_status:e,batch:""}))};return s.jsx(z,{onClose:t,children:s.jsxs("div",{className:U.modal_container,children:[s.jsx(A,{children:s.jsxs("div",{className:U.modal_container_outer_header,children:[s.jsx("div",{className:U.modal_container_header,children:s.jsx("h6",{children:o("overall_fee_statistics_filter")})}),s.jsx("img",{src:`${j}/close.svg`,alt:"close icon",onClick:t})]})}),s.jsx(V,{}),s.jsxs(A,{customStyle:{paddingTop:"0"},children:[s.jsx(R,{label:"activity_type",children:$==null?void 0:$.map(e=>s.jsx(B,{tile:e,onTile:c,activeTile:i.activity_status},e==null?void 0:e.key))}),i.activity_status?null:s.jsxs(s.Fragment,{children:[s.jsx(R,{label:"department_type",children:I==null?void 0:I.map(e=>s.jsx(B,{tile:e,onTile:C,activeTile:i.all_depart},e==null?void 0:e.key))}),i.all_depart==="PARTICULAR"?s.jsxs(s.Fragment,{children:[s.jsx(K,{fid:r,onSelect:p,onlyDepartment:!0}),s.jsx(R,{label:"batch_type",children:D==null?void 0:D.map(e=>s.jsx(B,{tile:e,onTile:E,activeTile:i.batch_status},e==null?void 0:e.key))}),i.batch_status==="PARTICULAR_BATCH"?s.jsx(X,{did:i.depart,onSelect:T,onlyBatch:!0}):null,s.jsx(Z,{did:i.depart,onSelect:y,instituteId:l})]}):null,s.jsx(F,{fid:r,onSelect:N})]}),s.jsx(M,{label:"filter",onAction:f})]}),h&&s.jsx(W,{})]})})},u=({label:t,amount:r,iconUrl:l})=>{const{t:a}=L();return s.jsxs("div",{className:_.osc_card,children:[s.jsx("img",{src:l,alt:"overal icon"}),s.jsxs("div",{className:_.osc_card_inner,children:[s.jsxs("h6",{children:[a("rs")," ",r??0]}),s.jsx("p",{children:a(t)})]})]})},ms=({fnanceOverallFeeStatistics:t})=>{const r=O(),l=ss(),a=es(),o=x.useCallback(()=>{r(`/${l.username}/member/staff/finance?type=fees-statistics&n=admission`,{state:a.state})},[r,l,a.state]);return console.info("fnanceOverallFeeStatistics",t),s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:_.osc_container,children:[s.jsxs("div",{className:_.osc_container_inner,children:[s.jsx(u,{iconUrl:`${j}/total-collected.svg`,amount:(t==null?void 0:t.total_fees)??0,label:"total_fees_to_be_collected"}),s.jsx(u,{iconUrl:`${j}/total-collection.svg`,amount:(t==null?void 0:t.total_collect)??0,label:"total_collection"}),s.jsx(u,{iconUrl:`${j}/total-fees.svg`,amount:(t==null?void 0:t.total_pending)??0,label:"total_fees"})]}),s.jsxs("div",{className:_.osc_container_inner,children:[s.jsx(u,{iconUrl:`${j}/student-collection.svg`,amount:0,label:"fees_to_be_collected_from_student"}),s.jsx(u,{iconUrl:`${j}/student-collection.svg`,amount:(t==null?void 0:t.collect_by_student)??0,label:"collection_from_student"}),s.jsx(u,{iconUrl:`${j}/student-pending.svg`,amount:(t==null?void 0:t.pending_by_student)??0,label:"outstanding_from_student"})]}),s.jsxs("div",{className:_.osc_container_inner,children:[s.jsx(u,{iconUrl:`${j}/gov-recieve.svg`,amount:0,label:"fees_to_be_receive_as_scholarship"}),s.jsx(u,{iconUrl:`${j}/gov-recieve.svg`,amount:(t==null?void 0:t.collect_by_government)??0,label:"collection_as_scholarship"}),s.jsx(u,{iconUrl:`${j}/gov-pending.svg`,amount:(t==null?void 0:t.pending_from_government)??0,label:"outstanding_as_scholarship"})]}),s.jsxs("div",{className:_.osc_container_inner,children:[s.jsx(u,{iconUrl:`${j}/excess-fee.svg`,amount:0,label:"other_internal_fees_to_be_collected"}),s.jsx(u,{iconUrl:`${j}/excess-fee.svg`,amount:0,label:"outstanding_internal_fees"}),s.jsx(u,{iconUrl:`${j}/excess-fee.svg`,amount:(t==null?void 0:t.excess_fees)??0,label:"excess_fees_paid_by_student"})]}),s.jsxs("div",{className:_.osc_container_inner,children:[s.jsx(u,{iconUrl:`${j}/total-deposit.svg`,amount:(t==null?void 0:t.total_deposits)??0,label:"deposits_to_be_refunded"}),s.jsx(u,{iconUrl:`${j}/total-income.svg`,amount:(t==null?void 0:t.incomes)??0,label:"other_incomes"}),s.jsx(u,{iconUrl:`${j}/total-expense.svg`,amount:(t==null?void 0:t.expenses)??0,label:"other_expenses"})]})]}),s.jsx(M,{label:"admission_fees_statitics",onAction:o,customStyle:{width:"fit-content"}})]})},hs=({fid:t,instituteId:r})=>{var N,f;const{t:l}=L(),[a,o]=x.useState(""),[i,m]=x.useState(!1),[h]=S(),{fnanceOverallFeeStatistics:d,fnanceOverallFeeStatisticsRefetch:b}=ls({fid:t,skip:!t}),p=x.useCallback(()=>{o("")},[]),T=()=>{o("FILTER")},y=()=>{var c;t&&(m(C=>!C),h({fid:t,moduleType:"OVERALL_VIEW",statisticsBody:{activity_status:"",all_depart:(c=d==null?void 0:d.fees_statistics_filter)==null?void 0:c.department_all,batch_status:"",master:[],batch:"",depart:"",bank:""}}).then(()=>{b(),m(C=>!C)}).catch({}))};return s.jsxs(s.Fragment,{children:[s.jsxs(q,{children:[s.jsx(A,{children:s.jsx("div",{className:g.fm_header_container,children:s.jsx("h6",{children:l("overall_fees_statitics")})})}),s.jsx(V,{}),s.jsxs(A,{customStyle:{paddingTop:"0.2rem"},children:[s.jsxs("div",{className:g.fm_fs_container,children:[s.jsxs("h6",{className:g.fm_title_heading,style:{flex:"2 2"},children:[l("applied_filter")," "," : ",(N=d==null?void 0:d.fees_statistics_filter)!=null&&N.department_all?`${(f=d==null?void 0:d.fees_statistics_filter)==null?void 0:f.department_all} Department`:""]}),s.jsxs("div",{className:g.fm_fs_container_inner,style:{flex:"1 1"},children:[s.jsx(M,{label:"filter",onAction:T,customStyle:{margin:"0"}}),s.jsxs("div",{className:g.fm_fs_refetch_container,onClick:y,children:[h!=null&&h.loading_status?s.jsx("img",{src:`${as}/loading.gif`,alt:"refetch icon"}):s.jsx("img",{src:`${j}/refresh.svg`,alt:"refetch icon"}),s.jsxs("div",{className:g.fm_fs_refetch_container_inner,children:[s.jsx("h6",{children:l("refetch_data")}),s.jsxs("p",{children:[l("last_updated")," : ",G(d==null?void 0:d.last_update).format("DD MMM YYYY"),", ",J(d==null?void 0:d.last_update,"LT")]})]})]})]})]}),s.jsx(ms,{fnanceOverallFeeStatistics:d})]})]}),a==="FILTER"?s.jsx(ds,{onClose:p,fid:t,instituteId:r,onRefetch:b}):null,i&&s.jsx(W,{})]})},xs=({statitics:t})=>{var l;const{t:r}=L();return s.jsx("div",{className:_.ss_table,children:s.jsxs("div",{className:_.fs_table_header,children:[s.jsx("div",{className:_.fs_table_col,style:{borderRight:"none"},children:Y==null?void 0:Y.map(a=>s.jsx("div",{className:_.fs_table_header_inner,children:s.jsx("h6",{className:_.fs_table_header_inner_h6,style:{width:"10rem"},children:r(a==null?void 0:a.name)})},a==null?void 0:a.name))}),(l=t==null?void 0:t.departs)==null?void 0:l.map((a,o)=>{var i,m;return s.jsxs("div",{className:_.fs_table_col,children:[s.jsx("div",{className:_.fs_table_header_inner,children:s.jsx("h6",{className:_.fs_table_header_inner_h6,children:a[`dp${o+1}`]})}),s.jsx("div",{className:_.fs_table_col_inner,children:(m=(i=t[`dp${o+1}`])==null?void 0:i.batches)==null?void 0:m.map(h=>{var d,b;return s.jsxs("div",{children:[s.jsx("div",{className:_.fs_table_header_inner,children:s.jsx("h6",{className:_.fs_table_header_inner_h6,children:h==null?void 0:h.batchName})}),s.jsx("div",{className:_.fs_table_col_inner,style:{alignItems:"flex-start"},children:(b=(d=t[`dp${o+1}`])==null?void 0:d.masters)==null?void 0:b.map(p=>{var T,y,N,f;return s.jsxs("div",{children:[s.jsx("div",{className:_.fs_table_header_inner,children:s.jsx("h6",{className:_.fs_table_header_inner_h6,style:{width:"10rem"},children:(p==null?void 0:p.masterName)??"NULL"})},p==null?void 0:p._id),s.jsx("div",{className:_.fs_table_col_inner,children:(f=(N=(y=js((T=t[`dp${o+1}`])==null?void 0:T.nest_classes,h==null?void 0:h._id))==null?void 0:y[h==null?void 0:h._id])==null?void 0:N.classes)==null?void 0:f.map(c=>(c==null?void 0:c.classMaster)===(p==null?void 0:p._id)?s.jsxs("div",{children:[s.jsx("div",{className:_.fs_table_header_inner,children:s.jsx("h6",{className:_.fs_table_header_inner_h6,style:{width:"10rem"},children:(c==null?void 0:c.className)??"NULL"})}),s.jsx("div",{className:_.fs_table_header_inner,children:s.jsx("h6",{className:_.fs_table_header_inner_h6,children:(c==null?void 0:c.total_fees)??"NULL"})}),s.jsx("div",{className:_.fs_table_header_inner,children:s.jsx("h6",{className:_.fs_table_header_inner_h6,children:(c==null?void 0:c.total_collect)??"NULL"})}),s.jsx("div",{className:_.fs_table_header_inner,children:s.jsx("h6",{className:_.fs_table_header_inner_h6,children:(c==null?void 0:c.total_pending)??"NULL"})}),s.jsx("div",{className:_.fs_table_header_inner,children:s.jsx("h6",{className:_.fs_table_header_inner_h6,children:(c==null?void 0:c.collect_by_student)??"NULL"})}),s.jsx("div",{className:_.fs_table_header_inner,children:s.jsx("h6",{className:_.fs_table_header_inner_h6,children:(c==null?void 0:c.pending_by_student)??"NULL"})}),s.jsx("div",{className:_.fs_table_header_inner,children:s.jsx("h6",{className:_.fs_table_header_inner_h6,children:(c==null?void 0:c.collect_by_government)??"NULL"})}),s.jsx("div",{className:_.fs_table_header_inner,children:s.jsx("h6",{className:_.fs_table_header_inner_h6,children:(c==null?void 0:c.pending_from_government)??"NULL"})})]},c==null?void 0:c._id):null)})]})})})]},h==null?void 0:h._id)})})]},o)})]})})},Y=[{name:"department"},{name:"batch"},{name:"standard"},{name:"class"},{name:"total_fees"},{name:"total_collect"},{name:"total_pending"},{name:"collect_by_student"},{name:"pending_by_student"},{name:"collect_by_gov"},{name:"pending_by_gov"}],js=(t,r)=>{for(let l of t)for(let a in l)if(a===r)return l},ps=({onClose:t,fid:r,instituteId:l,setStatitics:a})=>{const{t:o}=L(),[i,m]=x.useState({activity_status:"",all_depart:"",batch_status:"",master:[],batch:"",depart:"",bank:"",single_student:""}),[h,d]=x.useState(!1),[b]=S(),p=x.useCallback(e=>{e!=null&&e._id&&m(n=>({...n,all_depart:"PARTICULAR",depart:e==null?void 0:e._id}))},[]),T=x.useCallback(e=>{e!=null&&e._id?m(n=>({...n,batch_status:"PARTICULAR_BATCH",batch:e==null?void 0:e._id})):m(n=>({...n,batch_status:"ALL_BATCH",batch:""}))},[]),y=x.useCallback(e=>{m(n=>({...n,master:[e==null?void 0:e._id]}))},[]),N=x.useCallback(e=>{m(n=>({...n,bank:e==null?void 0:e._id}))},[]),f=()=>{r&&(d(e=>!e),b({fid:r,moduleType:"ADMISSION_VIEW",statisticsBody:i}).then(e=>{var n,H,P;((H=(n=e==null?void 0:e.data)==null?void 0:n.excel_list)==null?void 0:H.length)>0&&(a((P=e==null?void 0:e.data)==null?void 0:P.excel_list),t()),d(v=>!v)}).catch({}))},c=e=>{e===i.activity_status?m(n=>({...n,activity_status:"",batch:""})):m(n=>({...n,activity_status:e,batch:""}))},C=e=>{m(n=>({...n,all_depart:e,depart:""}))},E=e=>{m(n=>({...n,batch_status:e,batch:""}))};return s.jsx(z,{onClose:t,children:s.jsxs("div",{className:U.modal_container,children:[s.jsx(A,{children:s.jsxs("div",{className:U.modal_container_outer_header,children:[s.jsx("div",{className:U.modal_container_header,children:s.jsx("h6",{children:o("admission_fee_statistics_filter")})}),s.jsx("img",{src:`${j}/close.svg`,alt:"close icon",onClick:t})]})}),s.jsx(V,{}),s.jsxs(A,{customStyle:{paddingTop:"0"},children:[s.jsx(R,{label:"activity_type",children:$==null?void 0:$.map(e=>s.jsx(B,{tile:e,onTile:c,activeTile:i.activity_status},e==null?void 0:e.key))}),i.activity_status?null:s.jsxs(s.Fragment,{children:[s.jsx(R,{label:"department_type",children:I==null?void 0:I.map(e=>s.jsx(B,{tile:e,onTile:C,activeTile:i.all_depart},e==null?void 0:e.key))}),i.all_depart==="PARTICULAR"?s.jsxs(s.Fragment,{children:[s.jsx(K,{fid:r,onSelect:p,onlyDepartment:!0}),s.jsx(R,{label:"batch_type",children:D==null?void 0:D.map(e=>s.jsx(B,{tile:e,onTile:E,activeTile:i.batch_status},e==null?void 0:e.key))}),i.batch_status==="PARTICULAR_BATCH"?s.jsx(X,{did:i.depart,onSelect:T,onlyBatch:!0}):null,s.jsx(Z,{did:i.depart,onSelect:y,instituteId:l})]}):null,s.jsx(F,{fid:r,onSelect:N})]}),s.jsx(M,{label:"filter",onAction:f})]}),h&&s.jsx(W,{})]})})},us=({fid:t,instituteId:r})=>{const{t:l}=L(),[a,o]=x.useState(""),[i,m]=x.useState([]),h=x.useCallback(()=>{o("")},[]),d=()=>{o("FILTER")};return s.jsxs(s.Fragment,{children:[s.jsxs(q,{children:[s.jsx(A,{children:s.jsx("div",{className:g.fm_header_container,children:s.jsx("h6",{children:l("admission_fees_statitics")})})}),s.jsx(V,{}),s.jsxs(A,{customStyle:{paddingTop:"0.2rem"},children:[s.jsxs("div",{className:g.fm_fs_container,children:[s.jsxs("h6",{className:g.fm_title_heading,style:{flex:"2 2"},children:[l("apply_filter")," "," : "]}),s.jsxs("div",{className:g.fm_fs_container_inner,style:{flex:"1 1"},children:[s.jsx(M,{label:"filter",onAction:d,customStyle:{margin:"0"}}),s.jsxs("div",{className:g.fm_fs_refetch_container,children:[s.jsx("img",{src:`${j}/refresh.svg`,alt:"refetch icon"}),s.jsxs("div",{className:g.fm_fs_refetch_container_inner,children:[s.jsx("h6",{children:l("refetch_data")}),s.jsxs("p",{children:[l("last_updated")," : ",G().format("DD MMM YYYY"),", ",J("LT")]})]})]})]})]}),(i==null?void 0:i[0])&&s.jsx(xs,{statitics:i==null?void 0:i[0]})]})]}),a==="FILTER"?s.jsx(ps,{onClose:h,fid:t,instituteId:r,setStatitics:m}):null]})},Ws=({fid:t,instituteId:r})=>{const[l]=ts();return l.get("n")==="admission"?s.jsx(us,{instituteId:r,fid:t}):s.jsx(hs,{instituteId:r,fid:t})};export{Ws as default};
