import{r as o,j as e,w as C}from"./index-840de58d.js";import{U,s as d}from"./FinanceManager-0ca2f058.js";import{U as v,B as S}from"./UserMemberContentWrapper-d4cbea5a.js";import{u as E,c as p,f as x}from"./AssestsBaseUrl-3e7ac4b0.js";import{a1 as $,a2 as D,M as k,a as w,a3 as y,n as z,j as T}from"./StaffMemberConfig-7a36179e.js";import{F as B,d as L}from"./dayjs.min-1b7b0994.js";import{l as Y}from"./localTime-e3caacba.js";import{C as P}from"./CreateButton-390a73d1.js";import{s as b}from"./Income.module-ac045463.js";import{M as V}from"./Modal-6a8c66d1.js";import{L as W}from"./Loading-1f40e573.js";import"./UiTab.module-f6b989ec.js";import"./FormInputView-8f94e437.js";import"./auth-api-76ff487b.js";import"./MethodType-30df8d44.js";import"./checkingRequiredField-382733fa.js";import"./PlateformUser.module-0e3694bb.js";import"./decrypt-c89175fd.js";import"./UserDrawer-bfa56692.js";import"./BackdropModal-142f7ac8.js";import"./Utils.module-b6acf444.js";const X="_export_card_1xzgf_1",q="_export_card_image_1xzgf_17",O="_export_card_text_1xzgf_22",R="_export_card_date_1xzgf_36",G="_export_card_menu_1xzgf_49",u={export_card:X,export_card_image:q,export_card_text:O,export_card_date:R,export_card_menu:G},H=({onEditAction:t,onClose:a,xlsxId:r})=>{const{t:i}=E(),[_,c]=o.useState((r==null?void 0:r.excel_file_name)??""),[l,f]=o.useState("");o.useEffect(()=>{c((r==null?void 0:r.excel_file_name)??"")},[r==null?void 0:r.excel_file_name]);const j=s=>{c(s.target.value)},h=()=>{_?t(_):f({excelName:"excelName is required"})};return e.jsx(V,{onClose:a,children:e.jsxs("div",{className:b.modal_container,children:[e.jsx(v,{children:e.jsxs("div",{className:b.modal_container_outer_header,children:[e.jsx("div",{className:b.modal_container_header,children:e.jsx("h6",{children:i("update_excel_name")})}),e.jsx("img",{src:`${p}/close.svg`,alt:"close icon",onClick:a})]})}),e.jsx(S,{}),e.jsxs(v,{customStyle:{paddingTop:"0"},children:[e.jsx(B,{label:i("excel_name"),placeholder:i("excel_name_plcaeholder"),name:"excelName",value:_,type:"text",onChange:j,errorShow:l.excelName}),e.jsx(P,{label:"update",onAction:h})]})]})})},J=({onClose:t,xlsxId:a,instituteId:r})=>{const{t:i}=E(),[_,c]=o.useState(!1),[l,f]=o.useState(!1),[j]=$(),[h]=D(),s=()=>{r&&(a!=null&&a._id)&&(c(m=>!m),j({id:r,xlsxId:a==null?void 0:a._id}).then(()=>{t(),c(m=>!m)}).catch({}))},g=()=>{f(m=>!m)},N=m=>{r&&(a!=null&&a._id)&&(c(n=>!n),h({id:r,xlsxId:a==null?void 0:a._id,excelUpdate:{excel_file_name:m}}).then(()=>{c(n=>!n),t()}).catch({}))};return l?e.jsx(H,{onClose:g,onEditAction:N,xlsxId:a}):e.jsxs(k,{onClose:t,disabled:_,children:[e.jsx("h6",{onClick:g,children:i("edit")}),e.jsx("h6",{onClick:s,children:i("delete")})]})},F=({excel:t,instituteId:a})=>{const[r,i]=o.useState(""),_=()=>{i("")},c=l=>{l.preventDefault(),i(t)};return e.jsxs(e.Fragment,{children:[e.jsxs("a",{className:u.export_card,title:"Download File",href:`${C}/${t==null?void 0:t.excel_file}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx("img",{src:`${p}/xsxl.svg`,className:u.export_card_image,alt:"excel icon"}),e.jsxs("section",{className:u.export_card_text,children:[e.jsx("h6",{children:(t==null?void 0:t.excel_file_name)??""}),e.jsxs("div",{className:u.export_card_date,children:[e.jsx("h6",{children:L(t==null?void 0:t.created_at).format("DD MMM YYYY")}),e.jsx("h6",{children:Y(t==null?void 0:t.created_at,"LT")})]})]}),e.jsx("img",{src:`${p}/menu.svg`,alt:"menu icon",onClick:c,title:"Menu",className:u.export_card_menu})]},t==null?void 0:t._id),r&&e.jsx(J,{onClose:_,xlsxId:r,instituteId:a})]})},je=({instituteId:t})=>{const{t:a}=E(),[r,i]=o.useState(""),[_,c]=o.useState(1),[l,f]=o.useState(!0),[j,h]=w({skip:r}),{financeAllExcel:s,financeAllExcelLoading:g}=y({data:{id:t,page:_,limit:10,search:r},skip:!t});o.useEffect(()=>{h&&l&&c(n=>n+1)},[h,l]),o.useEffect(()=>{s!=null&&s.length&&z(s==null?void 0:s.length,f)},[s==null?void 0:s.length]);const N=o.useCallback(T(n=>i(n),500),[]),m=n=>{N(n.target.value)};return e.jsxs(U,{children:[e.jsx(v,{children:e.jsxs("div",{className:d.fm_header_container,children:[e.jsx("h6",{children:a("data_export")}),e.jsxs("div",{className:d.fm_both_filter,children:[e.jsxs("div",{className:d.fm_both_filter_with_name,children:[e.jsx("img",{src:`${p}/filter.svg`,alt:"filter icon"}),e.jsx("h6",{children:a("hostel_fee_receipt_filter")})]}),e.jsxs("div",{className:d.fm_both_filter_with_name,children:[e.jsx("img",{src:`${p}/filter.svg`,alt:"filter icon"}),e.jsx("h6",{children:a("fee_receipt_filter")})]}),e.jsxs("div",{className:d.fm_both_filter_with_name,children:[e.jsx("img",{src:`${p}/filter.svg`,alt:"filter icon"}),e.jsx("h6",{children:a("transaction_filter")})]})]})]})}),e.jsx(S,{}),e.jsxs(v,{customStyle:{paddingTop:"0"},children:[e.jsx("div",{className:d.fm_search_full,children:e.jsx("section",{className:d.fm_search_full_container,children:e.jsxs("div",{className:d.fm_search_full_container_inner,children:[e.jsx("img",{className:d.fm_search_full_icon,alt:"search icon",src:`${x}/navbar-search.svg`}),e.jsx("input",{type:"text",placeholder:a("search"),onChange:m})]})})}),g&&e.jsx(W,{}),s==null?void 0:s.map((n,M)=>(s==null?void 0:s.length)===M+1?e.jsx("div",{ref:j,children:e.jsx(F,{excel:n,instituteId:t})},n==null?void 0:n._id):e.jsx(F,{excel:n,instituteId:t},n==null?void 0:n._id))]})]})};export{je as default};
