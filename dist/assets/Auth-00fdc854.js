import{u as P,r as o,j as e}from"./index-840de58d.js";import{s as a,G as W}from"./GetStarted-4d1d9af9.js";import{A as B}from"./AuthCardWrapper-4ef1ccbb.js";import{A as y}from"./AuthFormFieldWithIcon-8fcc49e9.js";import{B as H,N as L}from"./NotifyEvent-5ab258fb.js";import{u as k,a as w}from"./AssestsBaseUrl-3e7ac4b0.js";import{u as O,a as $}from"./auth-api-76ff487b.js";import{r as G,e as V}from"./checkingRequiredField-382733fa.js";import{u as z}from"./use-login-7650e246.js";import{i as J,a as K,t as I}from"./invalidateAuthUsername-b1b2606f.js";import{d as R}from"./decrypt-c89175fd.js";import"./CreateButton-390a73d1.js";import"./Utils.module-b6acf444.js";import"./MethodType-30df8d44.js";const T=({isUser:c,onUserMobile:r})=>{const{t:n}=k(),h=P(),[s,v]=o.useState({insUserName:"",insPassword:""}),[b,_]=o.useState(!1),[g,x]=o.useState(""),[N,u]=o.useState({open:!1,msg:"",variant:"error"}),[j]=O(),{userDispatchAction:S}=z(),p=i=>{v(f=>({...f,[i.target.name]:i.target.value}))},d=i=>{i.preventDefault();let f=G(s);V(f)?(_(m=>!m),J(s==null?void 0:s.insUserName)?u({msg:"Special Character not allowed in username.",open:!0,variant:"error"}):j({login:s}).then(m=>{var C,q,F;const t=R((C=m==null?void 0:m.data)==null?void 0:C.encrypt);console.info("response",t),t!=null&&t.login?S({token:t==null?void 0:t.token,user:t==null?void 0:t.user,isUniversal:(q=t==null?void 0:t.user)==null?void 0:q.is_universal,phoneNumber:(F=t==null?void 0:t.user)==null?void 0:F.code_arr}):u({msg:"Invalid Credentials",open:!0,variant:"error"}),_(D=>!D)}).catch(m=>{u({msg:`Time out of request with reason ${m}`,open:!0,variant:"error"}),_(t=>!t)})):x(f)},l=()=>{let i="";c?i="/user/forget":i="/institute/forget",h(i)};return e.jsxs("form",{onSubmit:d,children:[e.jsx(y,{label:n("username"),placeholder:n("username_placeholder"),fieldIconUrl:`${w}/auth-user.svg`,validate:g.insUserName,name:"insUserName",value:s.insUserName,onChange:p}),e.jsx(y,{label:n("password"),placeholder:n("password_placeholder"),fieldIconUrl:`${w}/auth-password.svg`,validate:g.insPassword,name:"insPassword",value:s.insPassword,onChange:p,type:"password",isPassword:!0}),e.jsx("div",{className:a.auth_forget_container,children:e.jsx("p",{className:a.auth_forget_text,onClick:l,children:n("forgot_password")})}),e.jsx(H,{type:"submit",buttonText:n("login"),disabled:b}),c?e.jsx("div",{className:a.auth_footer_container,children:e.jsx("p",{className:a.auth_forget_text,onClick:r,children:n("continue_with_mobile_no")})}):e.jsx("div",{className:a.auth_footer_container,children:e.jsxs("p",{className:a.auth_forget_text,children:[n("new_to_qviple")," ",n("signup")]})}),e.jsx(L,{eventState:N,eventStateHandler:u})]})},Q=({onUserName:c})=>{const{t:r}=k(),n=P(),[h]=$(),[s,v]=o.useState(""),[b,_]=o.useState(!1),[g,x]=o.useState(""),[N,u]=o.useState({open:!1,msg:"",variant:"error"}),j=p=>{v(p.target.value)},S=p=>{p.preventDefault(),s?(_(d=>!d),h({userPhoneNumber:s,status:"Not Verified",is_qid:K(s)}).then(d=>{var i;let l=R((i=d==null?void 0:d.data)==null?void 0:i.encrypt);l!=null&&l.userPhoneNumber&&(n("/verify",{state:{phoneNumber:l==null?void 0:l.ePhone,type:I(s)==="qviple id"?"mobile number":I(s)}}),_(f=>!f))}).catch(()=>{u({open:!0,msg:"Time out of request...",variant:"error"})})):x({state:"* required"})};return e.jsxs("form",{onSubmit:S,className:a.auth_login_form,children:[e.jsx(y,{label:r("user_email_number_qviple_id"),placeholder:r("user_email_number_qviple_id_placeholder"),fieldIconUrl:`${w}/auth-flag.svg`,validate:g.state,name:"mobile_number",value:s,onChange:j}),e.jsxs("p",{className:a.auth_privacy_and_policy,children:[r("mobile_login_note")," ",e.jsx("span",{className:a.auth_privacy_and_policy_link,children:e.jsx("a",{href:"/q/terms/condition",children:r("terms_condition")})})," ",r("and"),e.jsx("span",{className:a.auth_privacy_and_policy_link,children:e.jsx("a",{href:"/q/privacy/policy",children:r("privacy_policy")})})]}),e.jsx(H,{type:"submit",buttonText:r("send_otp"),disabled:b}),e.jsx("div",{className:a.auth_footer_container,children:e.jsx("p",{className:a.auth_forget_text,onClick:c,children:r("login_with_user_name")})}),e.jsx(L,{eventState:N,eventStateHandler:u})]})},E="USER_MOBILE",A="USER_NAME",M="INSTITUTE_USER_NAME",U=[E,A],X=()=>{const{t:c}=k(),[r,n]=o.useState("USER_MOBILE"),h=()=>{n(E)},s=()=>{n(A)},v=()=>{n(M)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:a.auth_login_tab_container,children:[e.jsx("div",{className:U!=null&&U.includes(r)?a.auth_login_tab_active:a.auth_login_tab,onClick:h,children:c("user_staff_student")}),e.jsx("div",{className:r===M?a.auth_login_tab_active:a.auth_login_tab,onClick:v,children:c("institute")})]}),r===E?e.jsx(Q,{onUserName:s}):r===A?e.jsx(T,{isUser:!0,onUserMobile:h}):e.jsx(T,{})]})},me=()=>e.jsx(W,{children:e.jsx(B,{children:e.jsx(X,{})})});export{me as default};
