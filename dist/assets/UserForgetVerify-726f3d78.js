import{u as R,a as H,r as h,j as a}from"./index-244a15a9.js";import{G as I,s as v}from"./GetStarted-94dea1eb.js";import{A as W}from"./AuthCardWrapper-933ec47d.js";import{B as k,N as z}from"./NotifyEvent-7049182e.js";import{A as B}from"./AuthFormFieldWithIcon-3d62a3ef.js";import{r as D,e as G}from"./checkingRequiredField-382733fa.js";import{d as L,a as P}from"./auth-api-a6b9904c.js";import{u as V,a as M}from"./AssestsBaseUrl-00ad65e7.js";import{O as y}from"./OtpResendTimer-ebc99039.js";import{a as J}from"./invalidateAuthUsername-b1b2606f.js";import{d as O}from"./decrypt-87f2d320.js";import"./CreateButton-e61916de.js";import"./Utils.module-b6acf444.js";import"./MethodType-30df8d44.js";const dt=()=>{var x,_,N,S,$;const{t:n}=V(),g=R(),t=H(),[f,j]=h.useState({userOtpCode:""}),[K,b]=h.useState(!1),[C,F]=h.useState(""),[A,u]=h.useState({open:!1,msg:"",variant:"error"}),[T]=L(),[U]=P(),q=r=>{j(o=>({...o,userOtpCode:r.target.value}))},E=r=>{var m,i;r.preventDefault();let o=D(f);G(o)&&((m=t.state)!=null&&m.uid)?(b(e=>!e),T({uid:(i=t.state)==null?void 0:i.uid,otp:f}).then(e=>{var d,l,p;let s=O((d=e==null?void 0:e.data)==null?void 0:d.encrypt);(l=s==null?void 0:s.user)!=null&&l._id?g("/user/forget/password",{state:{uid:(p=s==null?void 0:s.user)==null?void 0:p._id}}):u({msg:"Invalid Otp",open:!0,variant:"error"}),b(c=>!c)}).catch(e=>{u({msg:`Time out of request with reason ${e}`,open:!0,variant:"error"}),b(s=>!s)})):F(o)},w=()=>{var r,o,m;(r=t==null?void 0:t.state)!=null&&r.phoneNumber&&U({userPhoneNumber:`${(o=t==null?void 0:t.state)==null?void 0:o.phoneNumber}`,status:"Not Verified",is_qid:J(`${(m=t==null?void 0:t.state)==null?void 0:m.phoneNumber}`)}).then(i=>{var s,d,l,p,c;let e=O((s=i==null?void 0:i.data)==null?void 0:s.encrypt);e!=null&&e.userPhoneNumber&&u({open:!0,msg:`Code will be resent to xxxx- ${(c=`${(d=t==null?void 0:t.state)==null?void 0:d.phoneNumber}`)==null?void 0:c.substring(((p=`${(l=t==null?void 0:t.state)==null?void 0:l.phoneNumber}`)==null?void 0:p.length)-4)}`,variant:"success"})}).catch(()=>{u({open:!0,msg:"Time out of request...",variant:"error"})})};return a.jsx(I,{children:a.jsx(W,{title:"forget_password_verification_code",subTitle:`${n("verification_code_note")}${((x=t.state)==null?void 0:x.type)??""}${n("ending")} ${($=`${(_=t==null?void 0:t.state)==null?void 0:_.phoneNumber}`)==null?void 0:$.substring(((S=`${(N=t==null?void 0:t.state)==null?void 0:N.phoneNumber}`)==null?void 0:S.length)-4)}`,subTitleStyle:{fontSize:"0.7rem"},titleStyle:{fontSize:"1rem"},children:a.jsxs("form",{onSubmit:E,className:v.auth_login_form,children:[a.jsx(B,{placeholder:n("verification_code"),fieldIconUrl:`${M}/auth-otp.svg`,maxLength:"4",validate:C.userOtpCode,name:"userOtpCode",value:f.userOtpCode,onChange:q}),a.jsx("div",{className:v.auth_footer_container,children:a.jsxs("p",{className:v.auth_otp_text,children:[n("if_you_did_not_recieve_otp"),a.jsx(y,{onOtpResend:w})]})}),a.jsx(k,{type:"submit",buttonText:n("verify")}),a.jsx(z,{eventState:A,eventStateHandler:u})]})})})};export{dt as default};
