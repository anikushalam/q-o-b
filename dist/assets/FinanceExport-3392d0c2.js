import{r as o,j as e,w as C}from"./index-244a15a9.js";import{U,s as d}from"./FinanceManager-db1d1088.js";import{B as S,M as x,L as $}from"./UserMemberProfileWrapper-960b6d0c.js";import{U as v}from"./UserMemberContentWrapper-31c60411.js";import{u as E,c as p,f as D}from"./AssestsBaseUrl-00ad65e7.js";import{u as k,n as w,c as y}from"./StaffMemberConfig-81165041.js";import{Y as z,Z as T,_ as Y}from"./finance-manager-api-ad25b769.js";import{F as B,d as L}from"./dayjs.min-cfa010e9.js";import{l as P}from"./localTime-0f856bcd.js";import{C as V}from"./CreateButton-e61916de.js";import{s as b}from"./Income.module-200dd9e8.js";import{M as W}from"./Modal-6d554a98.js";import"./UiTab.module-f6b989ec.js";import"./FormInputView-9b8ed792.js";import"./auth-api-a6b9904c.js";import"./MethodType-30df8d44.js";import"./checkingRequiredField-382733fa.js";import"./PlateformUser.module-0e3694bb.js";import"./decrypt-87f2d320.js";import"./Utils.module-b6acf444.js";const X="_export_card_1xzgf_1",q="_export_card_image_1xzgf_17",O="_export_card_text_1xzgf_22",R="_export_card_date_1xzgf_36",Z="_export_card_menu_1xzgf_49",u={export_card:X,export_card_image:q,export_card_text:O,export_card_date:R,export_card_menu:Z},G=({onEditAction:t,onClose:r,xlsxId:a})=>{const{t:i}=E(),[_,c]=o.useState((a==null?void 0:a.excel_file_name)??""),[l,f]=o.useState("");o.useEffect(()=>{c((a==null?void 0:a.excel_file_name)??"")},[a==null?void 0:a.excel_file_name]);const j=s=>{c(s.target.value)},h=()=>{_?t(_):f({excelName:"excelName is required"})};return e.jsx(W,{onClose:r,children:e.jsxs("div",{className:b.modal_container,children:[e.jsx(v,{children:e.jsxs("div",{className:b.modal_container_outer_header,children:[e.jsx("div",{className:b.modal_container_header,children:e.jsx("h6",{children:i("update_excel_name")})}),e.jsx("img",{src:`${p}/close.svg`,alt:"close icon",onClick:r})]})}),e.jsx(S,{}),e.jsxs(v,{customStyle:{paddingTop:"0"},children:[e.jsx(B,{label:i("excel_name"),placeholder:i("excel_name_plcaeholder"),name:"excelName",value:_,type:"text",onChange:j,errorShow:l.excelName}),e.jsx(V,{label:"update",onAction:h})]})]})})},H=({onClose:t,xlsxId:r,instituteId:a})=>{const{t:i}=E(),[_,c]=o.useState(!1),[l,f]=o.useState(!1),[j]=z(),[h]=T(),s=()=>{a&&(r!=null&&r._id)&&(c(m=>!m),j({id:a,xlsxId:r==null?void 0:r._id}).then(()=>{t(),c(m=>!m)}).catch({}))},g=()=>{f(m=>!m)},N=m=>{a&&(r!=null&&r._id)&&(c(n=>!n),h({id:a,xlsxId:r==null?void 0:r._id,excelUpdate:{excel_file_name:m}}).then(()=>{c(n=>!n),t()}).catch({}))};return l?e.jsx(G,{onClose:g,onEditAction:N,xlsxId:r}):e.jsxs(x,{onClose:t,disabled:_,children:[e.jsx("h6",{onClick:g,children:i("edit")}),e.jsx("h6",{onClick:s,children:i("delete")})]})},F=({excel:t,instituteId:r})=>{const[a,i]=o.useState(""),_=()=>{i("")},c=l=>{l.preventDefault(),i(t)};return e.jsxs(e.Fragment,{children:[e.jsxs("a",{className:u.export_card,title:"Download File",href:`${C}/${t==null?void 0:t.excel_file}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx("img",{src:`${p}/xsxl.svg`,className:u.export_card_image,alt:"excel icon"}),e.jsxs("section",{className:u.export_card_text,children:[e.jsx("h6",{children:(t==null?void 0:t.excel_file_name)??""}),e.jsxs("div",{className:u.export_card_date,children:[e.jsx("h6",{children:L(t==null?void 0:t.created_at).format("DD MMM YYYY")}),e.jsx("h6",{children:P(t==null?void 0:t.created_at,"LT")})]})]}),e.jsx("img",{src:`${p}/menu.svg`,alt:"menu icon",onClick:c,title:"Menu",className:u.export_card_menu})]},t==null?void 0:t._id),a&&e.jsx(H,{onClose:_,xlsxId:a,instituteId:r})]})},fe=({instituteId:t})=>{const{t:r}=E(),[a,i]=o.useState(""),[_,c]=o.useState(1),[l,f]=o.useState(!0),[j,h]=k({skip:a}),{financeAllExcel:s,financeAllExcelLoading:g}=Y({data:{id:t,page:_,limit:10,search:a},skip:!t});o.useEffect(()=>{h&&l&&c(n=>n+1)},[h,l]),o.useEffect(()=>{s!=null&&s.length&&w(s==null?void 0:s.length,f)},[s==null?void 0:s.length]);const N=o.useCallback(y(n=>i(n),500),[]),m=n=>{N(n.target.value)};return e.jsxs(U,{children:[e.jsx(v,{children:e.jsxs("div",{className:d.fm_header_container,children:[e.jsx("h6",{children:r("data_export")}),e.jsxs("div",{className:d.fm_both_filter,children:[e.jsxs("div",{className:d.fm_both_filter_with_name,children:[e.jsx("img",{src:`${p}/filter.svg`,alt:"filter icon"}),e.jsx("h6",{children:r("hostel_fee_receipt_filter")})]}),e.jsxs("div",{className:d.fm_both_filter_with_name,children:[e.jsx("img",{src:`${p}/filter.svg`,alt:"filter icon"}),e.jsx("h6",{children:r("fee_receipt_filter")})]}),e.jsxs("div",{className:d.fm_both_filter_with_name,children:[e.jsx("img",{src:`${p}/filter.svg`,alt:"filter icon"}),e.jsx("h6",{children:r("transaction_filter")})]})]})]})}),e.jsx(S,{}),e.jsxs(v,{customStyle:{paddingTop:"0"},children:[e.jsx("div",{className:d.fm_search_full,children:e.jsx("section",{className:d.fm_search_full_container,children:e.jsxs("div",{className:d.fm_search_full_container_inner,children:[e.jsx("img",{className:d.fm_search_full_icon,alt:"search icon",src:`${D}/navbar-search.svg`}),e.jsx("input",{type:"text",placeholder:r("search"),onChange:m})]})})}),g&&e.jsx($,{}),s==null?void 0:s.map((n,M)=>(s==null?void 0:s.length)===M+1?e.jsx("div",{ref:j,children:e.jsx(F,{excel:n,instituteId:t})},n==null?void 0:n._id):e.jsx(F,{excel:n,instituteId:t},n==null?void 0:n._id))]})]})};export{fe as default};
