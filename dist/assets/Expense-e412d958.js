import{r as h,j as e,Q as q}from"./index-840de58d.js";import{R,a as M,U as V,s as A}from"./FinanceManager-0ca2f058.js";import{X as D,Y as E,Z as Q,a as H,_ as O,n as B,j as X}from"./StaffMemberConfig-7a36179e.js";import{U as S,B as Y}from"./UserMemberContentWrapper-d4cbea5a.js";import{u as C,c as Z,f as $}from"./AssestsBaseUrl-3e7ac4b0.js";import{s as n}from"./Income.module-ac045463.js";import{d as L,F as z}from"./dayjs.min-1b7b0994.js";import{M as W}from"./Modal-6a8c66d1.js";import{F as U}from"./FormInputView-8f94e437.js";import{F as G}from"./FormFileView-dd40507c.js";import{A as J}from"./AddButton-399e6ce7.js";import{F as K}from"./FormFile-42079381.js";import{T as ee,a as se}from"./TileCard-9815c4ce.js";import{F as te,P as ae}from"./PlateformUser-522dec6f.js";import{F as re}from"./FormTextarea-b8631928.js";import{C as oe}from"./CreateButton-390a73d1.js";import{r as ne,e as ce}from"./checkingRequiredField-382733fa.js";import{t as le}from"./transaction_constant-ad8d613b.js";import{L as ie}from"./Loading-1f40e573.js";import"./UiTab.module-f6b989ec.js";import"./auth-api-76ff487b.js";import"./MethodType-30df8d44.js";import"./PlateformUser.module-0e3694bb.js";import"./decrypt-c89175fd.js";import"./UserDrawer-bfa56692.js";import"./BackdropModal-142f7ac8.js";import"./Utils.module-b6acf444.js";const de=({fid:s})=>{var t,d,m,u;const{t:c}=C(),{financeExpenseBalance:a}=D({fid:s,skip:!s});return e.jsxs("div",{className:n.right,children:[e.jsxs("div",{className:n.rightHead,style:{"--bg-expense-color":"rgb(231, 75, 75)"},children:[e.jsx("h6",{children:c("total_expense")}),e.jsxs("h6",{children:[c("rs"),((t=a==null?void 0:a.expenseBalance)==null?void 0:t.financeExpenseCashBalance)+((d=a==null?void 0:a.expenseBalance)==null?void 0:d.financeExpenseBankBalance)]})]}),e.jsxs("div",{className:n.rightBody,children:[e.jsxs("h6",{children:[" ",c("by_cash")," : ",c("rs"),(m=a==null?void 0:a.expenseBalance)==null?void 0:m.financeExpenseCashBalance]}),e.jsxs("h6",{children:[" ",c("by_bank")," : ",c("rs"),(u=a==null?void 0:a.expenseBalance)==null?void 0:u.financeExpenseBankBalance]})]})]})},me=h.memo(de),w=({expense:s,setExpenseId:c})=>{var d;const{t:a}=C(),t=()=>{c(s==null?void 0:s._id)};return e.jsxs("div",{onClick:t,className:n.card_container,children:[e.jsxs("h6",{className:n.invoice_number,children:[a("invoice_no")," "," : "," ",s==null?void 0:s.invoice_number]}),e.jsxs("div",{className:n.sidebarheader,children:[e.jsxs("div",{className:n.text,children:[e.jsx("p",{className:n.rcv,children:a("paid_to")}),e.jsx("h6",{children:s!=null&&s.expensePaid?s==null?void 0:s.expensePaid:(d=s==null?void 0:s.expensePaidUser)==null?void 0:d.userLegalName}),e.jsx("p",{className:n.rcv,children:L(s==null?void 0:s.createdAt).format("MMMM D, YYYY")})]}),e.jsxs("div",{className:n.text,children:[e.jsxs("p",{className:n.rcv,children:[s!=null&&s.expense_quantity?s==null?void 0:s.expense_quantity:"N/A"," ",a("quantity")]}),e.jsxs("h6",{children:[a("rs")," ",s==null?void 0:s.expenseAmount]}),e.jsx("p",{className:n.rcv,children:s==null?void 0:s.expenseAccount})]})]})]})},he=({onClose:s,expenseId:c})=>{var d,m,u,v,j,g,x,p,b,_;const{t:a}=C(),{financeExpenseDetail:t}=E({expenseId:c,skip:!c});return e.jsx(W,{onClose:s,children:e.jsxs("div",{className:n.income_detail,children:[e.jsxs("div",{className:n.detailTop,children:[e.jsx("div",{className:n.detailTopMid,children:e.jsx("h6",{children:(d=t==null?void 0:t.oneExpense)!=null&&d.expensePaid?(m=t==null?void 0:t.oneExpense)==null?void 0:m.expensePaid:(v=(u=t==null?void 0:t.oneExpense)==null?void 0:u.expensePaidUser)==null?void 0:v.userLegalName})}),e.jsx("div",{className:n.detailTopMid,children:e.jsxs("h6",{children:["Rs. ",(j=t==null?void 0:t.oneExpense)==null?void 0:j.expenseAmount]})})]}),e.jsxs(S,{children:[e.jsx(U,{label:`${a("transaction_mode")}: `,value:(g=t==null?void 0:t.oneExpense)==null?void 0:g.expenseAccount,customFormInput:{fontWeight:"500"}}),e.jsx(U,{label:`${a("description")}: `,value:(x=t==null?void 0:t.oneExpense)==null?void 0:x.expenseDesc,customFormInput:{fontWeight:"500"}}),e.jsx(U,{label:`${a("day_date")}: `,value:L((p=t==null?void 0:t.oneExpense)==null?void 0:p.createdAt).format("MMMM D, YYYY"),customFormInput:{fontWeight:"500"}}),(b=t==null?void 0:t.oneExpense)!=null&&b.expenseAck?e.jsx(G,{label:`${a("acknowlegement")}: `,value:{key:(_=t==null?void 0:t.oneExpense)==null?void 0:_.expenseAck},customFormInput:{fontWeight:"500"}}):null]})]})})},ue=({onClose:s,fid:c})=>{var o;const{t:a}=C(),[t,d]=h.useState({expenseAmount:"",expensePaid:"",expenseDesc:"",expenseAccount:"By Bank"}),[m,u]=h.useState(""),[v,j]=h.useState(!1),[g,x]=h.useState(!1),[p,b]=h.useState(""),[_,l]=h.useState(""),[P]=Q(),F=r=>{r.target.name==="expenseAmount"?d(i=>({...i,[r.target.name]:r.target.value})):d(i=>({...i,[r.target.name]:r.target.value}))},T=r=>{d(i=>({...i,expenseAccount:r}))},I=r=>{u(r.target.files[0])},f=()=>{let r=ne(t,["expenseDesc"]);if(ce(r)){if(c){j(y=>!y);const i=new FormData;i.append("expenseAmount",t.expenseAmount),p||i.append("expensePaid",t.expensePaid),i.append("expenseDesc",t.expenseDesc),i.append("expenseAccount",t.expenseAccount),i.append("file",m),P({fData:i,fid:c,is_inventory:"",user_query:p}).then(()=>{j(y=>!y),s()}).catch(()=>{j(y=>!y)})}}else l(r)},k=r=>{b(r==null?void 0:r._id),x(!1),d(i=>({...i,expensePaid:r==null?void 0:r.userLegalName}))},N=()=>{x(r=>!r)};return e.jsx(e.Fragment,{children:g?e.jsx(ae,{onSelectUser:k,selectedId:p,onClose:N}):e.jsx(W,{onClose:s,children:e.jsxs("div",{className:n.modal_container,children:[e.jsx(S,{children:e.jsxs("div",{className:n.modal_container_outer_header,children:[e.jsx("div",{className:n.modal_container_header,children:e.jsx("h6",{children:a("add_expense_receipt")})}),e.jsx("img",{src:`${Z}/close.svg`,alt:"close icon",onClick:s})]})}),e.jsx(Y,{customStyleBorder:{marginBottom:"0"}}),e.jsxs(R,{children:[e.jsx(M,{label:"nominal_expenses",isActive:!0}),e.jsx(M,{label:"assets_inventory"})]}),e.jsxs(S,{customStyle:{paddingTop:"0"},children:[e.jsx(ee,{label:"select_transaction_mode",children:(o=le)==null?void 0:o.map(r=>e.jsx(se,{tile:r,onTile:T,activeTile:t.expenseAccount},r==null?void 0:r.key))}),e.jsx(z,{label:a("amount"),placeholder:a("amount_placeholder"),name:"expenseAmount",value:t.expenseAmount,type:"text",onChange:F,errorShow:_.expenseAmount}),e.jsx(te,{label:a("paid_to"),placeholder:a("paid_to_placeholder"),name:"expensePaid",value:t.expensePaid,type:"text",onChange:F,errorShow:_.expensePaid,iconUrl:`${$}/navbar-search.svg`,searchLabel:"search_and_select",onSearchAction:N}),e.jsx(re,{label:a("description"),placeholder:a("description_placeholder"),name:"expenseDesc",value:t.expenseDesc,type:"text",onChange:F,errorShow:_.expenseDesc}),e.jsx(K,{label:a("acknowlegement_receipt"),name:"acknowlegement_receipt",value:m!=null&&m.name?{name:m==null?void 0:m.name}:"",onChange:I}),e.jsx(oe,{label:"save_receipt",onAction:f})]}),v&&e.jsx(q,{})]})})})},Re=({fid:s})=>{var k,N;const{t:c}=C(),[a,t]=h.useState(""),[d,m]=h.useState(1),[u,v]=h.useState(!0),[j,g]=H({skip:a}),[x,p]=h.useState(""),[b,_]=h.useState(!1),{financeExpense:l,financeExpenseLoading:P}=O({data:{fid:s,page:d,limit:10,search:a},skip:!s});h.useEffect(()=>{g&&u&&m(o=>o+1)},[g,u]),h.useEffect(()=>{var o;(o=l==null?void 0:l.allIncome)!=null&&o.length&&B(l==null?void 0:l.length,v)},[(k=l==null?void 0:l.allIncome)==null?void 0:k.length,B]);const F=h.useCallback(X(o=>t(o),500),[]),T=o=>{F(o.target.value)},I=()=>{p("")},f=()=>{_(o=>!o)};return e.jsxs(e.Fragment,{children:[e.jsxs(V,{children:[e.jsx(S,{children:e.jsxs("div",{className:A.fm_header_container,children:[e.jsx("h6",{children:c("expense_history")}),e.jsx("div",{className:A.fm_search,children:e.jsx("section",{className:A.fm_search_container,children:e.jsxs("div",{className:A.fm_search_container_inner,children:[e.jsx("img",{className:A.fm_search_icon,alt:"search icon",src:`${$}/navbar-search.svg`}),e.jsx("input",{type:"text",placeholder:c("search"),onChange:T})]})})})]})}),e.jsx(Y,{}),e.jsxs(S,{customStyle:{paddingTop:"0.2rem"},children:[e.jsxs("div",{className:A.fm_add_button,children:[e.jsx(me,{fid:s}),e.jsx(J,{label:"add_new_expense",onAction:f})]}),P&&e.jsx(ie,{}),(N=l==null?void 0:l.allIncome)==null?void 0:N.map((o,r)=>{var i;return((i=l==null?void 0:l.allIncome)==null?void 0:i.length)===r+1?e.jsx("div",{ref:j,children:e.jsx(w,{expense:o,setExpenseId:p})},o==null?void 0:o._id):e.jsx(w,{expense:o,setExpenseId:p},o==null?void 0:o._id)})]})]}),x&&e.jsx(he,{onClose:I,expenseId:x}),b&&e.jsx(ue,{onClose:f,fid:s})]})};export{Re as default};
