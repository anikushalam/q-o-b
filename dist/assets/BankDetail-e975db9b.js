import{j as a,i as R,r as p,a as W,Q as J,u as O,l as X}from"./index-840de58d.js";import{F as Y,s as E,U as Z}from"./FinanceManager-0ca2f058.js";import{U as q,B as U}from"./UserMemberContentWrapper-d4cbea5a.js";import{u as F,c as D}from"./AssestsBaseUrl-3e7ac4b0.js";import{L as M,m as k,N as B,O as ee,P as te,M as ae,Q as _e}from"./StaffMemberConfig-7a36179e.js";import{F as w,H as ie,a as ce}from"./FormInputView-8f94e437.js";import{L as se}from"./Loading-1f40e573.js";import{F as I}from"./dayjs.min-1b7b0994.js";import{F as re}from"./FormFile-42079381.js";import{h as le}from"./auth-api-76ff487b.js";import{M as ne}from"./Modal-6a8c66d1.js";import{C as V}from"./CustomSelectDepartment-370633fe.js";import{C as de}from"./CreateButton-390a73d1.js";import"./UiTab.module-f6b989ec.js";import"./checkingRequiredField-382733fa.js";import"./PlateformUser.module-0e3694bb.js";import"./decrypt-c89175fd.js";import"./MethodType-30df8d44.js";import"./UserDrawer-bfa56692.js";import"./BackdropModal-142f7ac8.js";import"./Utils.module-b6acf444.js";const oe="_bank_detail_card_5irix_1",me="_bank_detail_card_heading_5irix_19",ue="_bank_detail_card_inner_5irix_31",fe="_bank_detail_applicable_5irix_39",he="_bank_detail_card_upi_5irix_53",pe="_bank_detail_card_qr_5irix_59",be="_bank_detail_list_5irix_75",xe="_save_button_5irix_83",je="_applicable_btn_container_5irix_97",ge="_applicable_btn_5irix_97",we="_applicable_text_5irix_127",ve="_applicable_text_error_5irix_134",Se="_applicable_container_5irix_140",Ne="_bank_fund_container_5irix_150",Fe="_bank_fund_5irix_150",Ce="_bank_details_5irix_180",Ie="_bank_upi_5irix_197",ye="_bank_qr_code_5irix_207",qe="_bank_qr_code_text_5irix_220",u={bank_detail_card:oe,bank_detail_card_heading:me,bank_detail_card_inner:ue,bank_detail_applicable:fe,bank_detail_card_upi:he,bank_detail_card_qr:pe,bank_detail_list:be,save_button:xe,applicable_btn_container:je,applicable_btn:ge,applicable_text:we,applicable_text_error:ve,applicable_container:Se,bank_fund_container:Ne,bank_fund:Fe,bank_details:Ce,bank_upi:Ie,bank_qr_code:ye,bank_qr_code_text:qe};let y={fontWeight:"400"};const $e=({bank:e})=>{var c,l,b,n,d,s,i,j;const{t:_}=F();return a.jsxs("div",{className:u.bank_detail_card,children:[a.jsxs("div",{className:u.bank_detail_card_heading,children:[a.jsx("img",{src:`${D}/bank-card.svg`,alt:"bank icon"}),a.jsxs("div",{className:u.bank_detail_card_inner,children:[a.jsx("h6",{children:(e==null?void 0:e.finance_bank_name)??""}),a.jsx("p",{children:(c=e==null?void 0:e.department)!=null&&c.dName?(l=e==null?void 0:e.department)==null?void 0:l.dName:e!=null&&e.hostel?"Hostel":e!=null&&e.library?"Library":e!=null&&e.transport?"Transport":((b=e==null?void 0:e.departments)==null?void 0:b.length)>0?(n=e==null?void 0:e.departments)==null?void 0:n.map((m,x)=>{var f;return a.jsxs("span",{children:[(m==null?void 0:m.dName)??"",x+1===((f=e==null?void 0:e.departments)==null?void 0:f.length)?"":", "]},m==null?void 0:m._id)}):""})]})]}),a.jsxs("section",{className:u.bank_detail_applicable,children:[a.jsxs("h6",{children:[_("applicable_for")," "," : "," "]}),a.jsx(w,{label:(d=e==null?void 0:e.department)!=null&&d.dName?(s=e==null?void 0:e.department)==null?void 0:s.dName:e!=null&&e.hostel?"Hostel":e!=null&&e.library?"Library":e!=null&&e.transport?"Transport":((i=e==null?void 0:e.departments)==null?void 0:i.length)>0?(j=e==null?void 0:e.departments)==null?void 0:j.map((m,x)=>{var f;return a.jsxs("span",{children:[(m==null?void 0:m.dName)??"",x+1===((f=e==null?void 0:e.departments)==null?void 0:f.length)?"":", "]},m==null?void 0:m._id)}):"",customFormInputLabel:y})]}),a.jsxs("section",{className:u.bank_detail_applicable,children:[a.jsx("h6",{children:_("bank_details")}),a.jsx(w,{label:`${_("bank_name")} :`,value:e==null?void 0:e.finance_bank_name,customFormInput:y}),a.jsx(w,{label:`${_("account_name")} :`,value:e==null?void 0:e.finance_bank_account_name,customFormInput:y}),a.jsx(w,{label:`${_("account_number")} :`,value:e==null?void 0:e.finance_bank_account_number,customFormInput:y}),a.jsx(w,{label:`${_("ifsc_code")} :`,value:e==null?void 0:e.finance_bank_ifsc_code,customFormInput:y}),a.jsx(w,{label:`${_("address")} :`,value:e==null?void 0:e.finance_bank_branch_address,customFormInput:y})]}),a.jsx(w,{label:`${_("upi_id")} :`,value:e==null?void 0:e.finance_bank_upi_id,customFormInput:y}),a.jsxs("section",{className:u.bank_detail_card_upi,style:{width:"100%",alignItems:"flex-start"},children:[a.jsxs("div",{className:u.bank_detail_card_qr,children:[a.jsxs("h6",{children:[_("qr_code"),":"]}),a.jsx("p",{children:(e==null?void 0:e.finance_bank_upi_id)??""})]}),e!=null&&e.finance_bank_upi_qrcode?a.jsx("img",{src:`${R}/${e==null?void 0:e.finance_bank_upi_qrcode}`,alt:"qr code"}):""]})]})},Le=({fid:e})=>{var b;const _=W(),{financeAllBank:c,financeAllBankLoading:l}=M({data:{fid:e,page:1,limit:40,search:""},skip:!e});return a.jsxs("div",{className:u.bank_detail_list,children:[l&&a.jsx(se,{}),(b=c==null?void 0:c.all_accounts)==null?void 0:b.map(n=>a.jsx("div",{style:{width:"49%"},children:a.jsx(Y,{parentState:{..._.state,bankId:n==null?void 0:n._id},activeUrl:"type=bank&n=detail",children:a.jsx($e,{bank:n})},n==null?void 0:n._id)}))]})},De=p.memo(Le),Ae=({fid:e,onToggle:_,libraryId:c,transportId:l,hostelId:b,setApplicablFor:n})=>{var h,o;const{t:d}=F(),[s,i]=p.useState({flow:"",flow_id:"",flow_name:"",depart_arr:[]}),{instituteAllDepartment:j}=k({fid:e,skip:!e}),m=r=>{r==="Hostel"?i({flow:"Hostel",flow_id:b,flow_name:"Hostel",depart_arr:[]}):r==="Transport"?i({flow:"Transport",flow_id:l,flow_name:"Transport",depart_arr:[]}):r==="Library"?i({flow:"Library",flow_id:c,flow_name:"Library",depart_arr:[]}):r==="Internal Department"&&i({flow:"Department",flow_id:"",flow_name:"",depart_arr:[]})},x=r=>{i($=>({...$,flow_id:r==null?void 0:r._id,flow_name:r==null?void 0:r.dName,depart_arr:[...new Set([...$.depart_arr,r==null?void 0:r._id])]}))},f=()=>{n(s),_()};return a.jsx(ne,{onClose:_,children:a.jsx("div",{className:u.applicable_container,children:a.jsxs(q,{children:[a.jsx(V,{selectLabel:d("applicable_for"),selectedValue:d("applicable_for_placeholder"),options:["Internal Department","Transport","Library","Hostel"],onClick:m,isFull:!0}),s.flow==="Department"&&a.jsx(V,{selectLabel:d("select_internal_department"),selectedValue:d("select_internal_department_placeholder"),options:j??[],onClick:x,isFull:!0,viewAs:"NORMAL_FILTER",defalutValue:((h=s.depart_arr)==null?void 0:h.length)>1?`${(o=s.depart_arr)==null?void 0:o.length} department selected`:s.flow_name}),a.jsx("button",{className:u.applicable_btn,onClick:f,style:{width:"100%",justifyContent:"center"},children:a.jsx("div",{children:d("select")})})]})})})},Te=({errorField:e,applicableFor:_,libraryId:c,transportId:l,hostelId:b,setApplicablFor:n,fid:d})=>{var x,f;const{t:s}=F(),[i,j]=p.useState(!1),m=p.useCallback(()=>{j(h=>!h)},[]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:u.applicable_btn_container,children:[a.jsxs("button",{className:u.applicable_btn,onClick:m,children:[a.jsx("div",{children:s("account_applicable_for")}),a.jsx("img",{src:`${D}/forward.svg`,alt:"next step"})]}),(_==null?void 0:_.flow_name)&&a.jsx("h6",{className:u.applicable_text,children:((x=_==null?void 0:_.depart_arr)==null?void 0:x.length)>1?`${(f=_==null?void 0:_.depart_arr)==null?void 0:f.length} department selected`:_==null?void 0:_.flow_name})]}),e.flow_id&&a.jsxs("p",{className:u.applicable_text_error,children:["* ",s("form_require_label")]}),i&&a.jsx(Ae,{fid:d,onToggle:m,libraryId:c,transportId:l,hostelId:b,setApplicablFor:n})]})},Ee=p.memo(Te),z=({onClose:e,fid:_,libraryId:c,transportId:l,hostelId:b,openAs:n,onEditAction:d,openBankMenu:s})=>{const{t:i}=F(),[j]=le(),[m]=B(),[x,f]=p.useState(!1),[h,o]=p.useState(""),[r,$]=p.useState({finance_bank_name:"",finance_bank_account_number:"",finance_bank_account_name:"",finance_bank_ifsc_code:"",finance_bank_branch_address:"",finance_bank_upi_id:"",finance_bank_upi_qrcode:"",finance_bank_re_account_number:"",finance_bank_re_upi_id:""}),[A,P]=p.useState({flow:"",flow_id:"",flow_name:"",depart_arr:[]}),[L,K]=p.useState("");p.useEffect(()=>{n==="EDIT"&&$({finance_bank_name:(s==null?void 0:s.finance_bank_name)??"",finance_bank_account_number:(s==null?void 0:s.finance_bank_account_number)??"",finance_bank_account_name:(s==null?void 0:s.finance_bank_account_name)??"",finance_bank_ifsc_code:(s==null?void 0:s.finance_bank_ifsc_code)??"",finance_bank_branch_address:(s==null?void 0:s.finance_bank_branch_address)??"",finance_bank_upi_id:(s==null?void 0:s.finance_bank_upi_id)??"",finance_bank_upi_qrcode:(s==null?void 0:s.finance_bank_upi_qrcode)??"",finance_bank_re_account_number:(s==null?void 0:s.finance_bank_account_number)??"",finance_bank_re_upi_id:(s==null?void 0:s.finance_bank_upi_id)??""})},[n]);const C=S=>{$(N=>({...N,[S.target.name]:S.target.value}))},Q=p.useCallback(S=>{f(v=>!v);const N=new FormData;K(S.target.files[0]),N.append("file",S.target.files[0]),j({fileUpload:N}).then(v=>{f(T=>!T),$(T=>{var H;return{...T,finance_bank_upi_qrcode:(H=v.data)==null?void 0:H.imageKey}})}).catch(()=>{f(v=>!v)})},[]),G=p.useCallback(()=>{if(n==="EDIT"){const S=He(r);let N=!1;for(let v in S){N=!0;break}N?o(S):d(r)}else{const S=Ue(r,A);let N=!1;for(let v in S){N=!0;break}N?o(S):(f(v=>!v),m({fid:_,...A,bankDetails:{...r,depart_arr:A.depart_arr}}).then(()=>{e(),f(v=>!v)}).catch(()=>{f(v=>!v)}))}},[r]);return a.jsxs(a.Fragment,{children:[a.jsx(q,{children:a.jsxs("div",{className:E.fm_header_start_container,children:[a.jsx("img",{src:`${D}/back-arrow.svg`,alt:"back arrow",title:"Add Bank",onClick:e}),a.jsxs("h6",{children:[" ",i(n==="EDIT"?"update_bank_details":"add_bank_details")]})]})}),a.jsx(U,{}),a.jsxs(q,{customStyle:{paddingTop:"0"},children:[n==="EDIT"?null:a.jsx(Ee,{applicableFor:A,errorField:h,fid:_,libraryId:c,transportId:l,hostelId:b,setApplicablFor:P}),a.jsx(I,{label:i("bank_name"),placeholder:i("bank_name_placeholder"),name:"finance_bank_name",value:r.finance_bank_name,type:"text",onChange:C,errorShow:h.finance_bank_name}),a.jsx(I,{label:i("account_name"),placeholder:i("account_name_placeholder"),name:"finance_bank_account_name",value:r.finance_bank_account_name,type:"text",onChange:C,errorShow:h.finance_bank_account_name}),a.jsx(I,{label:i("account_number"),placeholder:i("account_number_placeholder"),name:"finance_bank_account_number",value:r.finance_bank_account_number,type:"tel",onChange:C,errorShow:h.finance_bank_name}),a.jsx(I,{label:i("confirm_account_number"),placeholder:i("confirm_account_number_placeholder"),name:"finance_bank_re_account_number",value:r.finance_bank_re_account_number,type:"tel",onChange:C,errorShow:h.finance_bank_re_account_number,msg:h.finance_bank_re_account_number}),a.jsx(I,{label:i("ifsc_code"),placeholder:i("ifsc_code_placeholder"),name:"finance_bank_ifsc_code",value:r.finance_bank_ifsc_code,type:"text",onChange:C,errorShow:h.finance_bank_ifsc_code}),a.jsx(I,{label:i("address_of_bank"),placeholder:i("address_of_bank_placeholder"),name:"finance_bank_branch_address",value:r.finance_bank_branch_address,type:"text",onChange:C,errorShow:h.finance_bank_branch_address}),a.jsx(I,{label:i("upi_id"),placeholder:i("upi_id_placeholder"),name:"finance_bank_upi_id",value:r.finance_bank_upi_id,type:"text",onChange:C,errorShow:h.finance_bank_upi_id}),a.jsx(I,{label:i("confirm_upi_id"),placeholder:i("finance_bank_re_upi_id"),name:"finance_bank_re_upi_id",value:r.finance_bank_re_upi_id,type:"text",onChange:C,errorShow:h.finance_bank_re_upi_id,msg:h.finance_bank_re_upi_id}),a.jsx(re,{label:i("qr_code_above_upi"),name:"finance_bank_upi_qrcode",value:L!=null&&L.name?{name:L==null?void 0:L.name}:"",onChange:Q,errorShow:h.finance_bank_upi_qrcode}),a.jsx(de,{label:"save",onAction:G})]}),x&&a.jsx(J,{})]})},Ue=(e,_)=>{const c={};for(let l in e)l==="finance_bank_account_number"&&e.finance_bank_account_number!==e.finance_bank_re_account_number?c.finance_bank_re_account_number=`${t("form_account_dose_not_match_label")}`:l==="finance_bank_upi_id"&&e.finance_bank_upi_id!==e.finance_bank_re_upi_id?c.finance_bank_re_upi_id=`${t("upi_id_dose_not_match_label")}`:e[l]||(c[l]="* required");return _!=null&&_.flow_id||(c.flow_id="flow_id is required"),c},He=e=>{const _={};for(let c in e)c==="finance_bank_account_number"&&e.finance_bank_account_number!==e.finance_bank_re_account_number?_.finance_bank_re_account_number=`${t("form_account_dose_not_match_label")}`:c==="finance_bank_upi_id"&&e.finance_bank_upi_id!==e.finance_bank_re_upi_id?_.finance_bank_re_upi_id=`${t("upi_id_dose_not_match_label")}`:e[c]||(_[c]="* required");return _},Ve=({totalRepay:e,collectOnline:_,dueRepay:c})=>{const{t:l}=F();return a.jsxs("div",{className:u.bank_fund_container,children:[a.jsxs("div",{className:u.bank_fund,children:[a.jsx("h6",{children:l("total_due")}),a.jsxs("h5",{children:[l("rs")," ",e??0]})]}),a.jsxs("div",{className:u.bank_fund,children:[a.jsx("h6",{children:l("online_fees")}),a.jsxs("h5",{children:[l("rs")," ",_??0]})]}),a.jsxs("div",{className:u.bank_fund,children:[a.jsx("h6",{children:l("repayment_due")}),a.jsxs("h5",{children:[l("rs")," ",c??0]})]})]})},g={fontWeight:"400",fontSize:"12px"},Re=({oneBank:e})=>{var c,l,b,n;const{t:_}=F();return a.jsxs(a.Fragment,{children:[a.jsxs("section",{className:u.bank_details,children:[a.jsxs("h6",{children:[_("applicable_for")," "," : "," "]}),a.jsx(w,{label:"",value:(c=e==null?void 0:e.department)!=null&&c.dName?(l=e==null?void 0:e.department)==null?void 0:l.dName:e!=null&&e.hostel?"Hostel":e!=null&&e.library?"Library":e!=null&&e.transport?"Transport":((b=e==null?void 0:e.departments)==null?void 0:b.length)>0?(n=e==null?void 0:e.departments)==null?void 0:n.map((d,s)=>{var i;return a.jsxs("span",{children:[(d==null?void 0:d.dName)??"",s+1===((i=e==null?void 0:e.departments)==null?void 0:i.length)?"":", "]},d==null?void 0:d._id)}):"",customFormInput:g,customFormInputLabel:{...g,marginLeft:"-0.8rem"}})]}),a.jsxs("section",{className:u.bank_details,children:[a.jsx("h6",{children:_("bank_details")}),a.jsx(w,{label:`${_("bank_name")} :`,value:e==null?void 0:e.finance_bank_name,customFormInput:g,customFormInputLabel:g}),a.jsx(w,{label:`${_("account_name")} :`,value:e==null?void 0:e.finance_bank_account_name,customFormInput:g,customFormInputLabel:g}),a.jsx(w,{label:`${_("account_number")} :`,value:e==null?void 0:e.finance_bank_account_number,customFormInput:g,customFormInputLabel:g}),a.jsx(w,{label:`${_("ifsc_code")} :`,value:e==null?void 0:e.finance_bank_ifsc_code,customFormInput:g,customFormInputLabel:g}),a.jsx(w,{label:`${_("address")} :`,value:e==null?void 0:e.finance_bank_branch_address,customFormInput:g,customFormInputLabel:g})]}),a.jsx("section",{className:u.bank_upi,children:a.jsx(w,{label:`${_("upi_id")} :`,value:e==null?void 0:e.finance_bank_upi_id,customFormInput:g,customFormInputLabel:g})}),a.jsxs("section",{className:u.bank_qr_code,children:[a.jsxs("div",{className:u.bank_qr_code_text,children:[a.jsxs("h6",{children:[_("qr_code"),":"]}),a.jsx("p",{children:(e==null?void 0:e.finance_bank_upi_id)??""})]}),e!=null&&e.finance_bank_upi_qrcode?a.jsx("img",{src:`${R}/${e==null?void 0:e.finance_bank_upi_qrcode}`,alt:"qr code"}):""]})]})},We=({onToggle:e,setBankEdit:_,openBankMenu:c})=>{const{t:l}=F(),b=O(),[n,d]=p.useState(!1),[s,i]=p.useState(!1),[j]=ee(),[m]=te(),x=()=>{_(o=>!o),i(o=>!o)},f=()=>{c!=null&&c._id&&(d(o=>!o),j(c==null?void 0:c._id).then(()=>{e(),d(o=>!o),b(-1)}).catch({}))},h=o=>{c!=null&&c._id&&(d(r=>!r),i(!1),m({bid:c==null?void 0:c._id,bankDetails:o}).then(()=>{d(r=>!r),e(),_(r=>!r)}).catch({}))};return s?a.jsx(z,{onClose:x,openAs:"EDIT",onEditAction:h,openBankMenu:c}):a.jsxs(ae,{onClose:e,disabled:n,children:[a.jsx("h6",{onClick:x,children:l("edit")}),a.jsx("h6",{onClick:f,children:l("delete")})]})},ze=[{label:"bank_info",id:0},{label:"fund",id:1}],Pe=()=>{var x,f,h;const{t:e}=F(),_=W(),[c,l]=p.useState(0),[b,n]=p.useState(!1),[d,s]=p.useState(!1),{financeOneBankDetail:i}=_e({bid:_.state.bankId,skip:!_.state.bankId}),j=p.useCallback(()=>{n(o=>!o)},[]),m=o=>{l(o)};return a.jsxs(a.Fragment,{children:[!d&&a.jsxs(a.Fragment,{children:[a.jsxs(q,{children:[a.jsxs("div",{className:E.fm_header_container,children:[a.jsx("h6",{children:e("bank_details")}),a.jsx("img",{src:`${D}/edit.svg`,alt:"back arrow",title:"Edit Bank",onClick:j})]}),a.jsx(ie,{children:ze.map(o=>a.jsx(ce,{tab:o,isActive:(o==null?void 0:o.id)===c,onAction:m},o==null?void 0:o.id))}),a.jsx(U,{customStyleBorder:{marginTop:"0"}})]}),a.jsx(q,{children:c===0?a.jsx(Re,{oneBank:i==null?void 0:i.one_bank}):a.jsx(Ve,{totalRepay:(x=i==null?void 0:i.one_bank)==null?void 0:x.total_repay,collectOnline:(f=i==null?void 0:i.one_bank)==null?void 0:f.collect_online,dueRepay:(h=i==null?void 0:i.one_bank)==null?void 0:h.due_repay})})]}),b&&a.jsx(We,{onToggle:j,setBankEdit:s,openBankMenu:i==null?void 0:i.one_bank})]})},Ke=({fid:e,libraryId:_,transportId:c,hostelId:l})=>{const{t:b}=F(),[n]=X(),[d,s]=p.useState(!1),i=p.useCallback(()=>{s(j=>!j)},[]);return a.jsx(Z,{children:d?a.jsx(z,{fid:e,libraryId:_,transportId:c,hostelId:l,onClose:i}):n.get("n")?a.jsx(Pe,{fid:e,libraryId:_,transportId:c,hostelId:l}):a.jsxs(a.Fragment,{children:[a.jsx(q,{children:a.jsxs("div",{className:E.fm_header_container,children:[a.jsx("h6",{children:b("bank_account_detail")}),a.jsx("img",{src:`${D}/plus-blue.svg`,alt:"back arrow",title:"Add Bank",onClick:i})]})}),a.jsx(U,{}),a.jsx(q,{children:a.jsx(De,{fid:e})})]})})},ot=p.memo(Ke);export{ot as default};
