import{f as Q,a as W,r as c,j as a,L as A,i as J,Q as Y,_ as q,l as X}from"./index-0b7f6bad.js";import{s as x,U as Z}from"./FinanceManager-a3d1c044.js";import{U as b}from"./UserMemberContentWrapper-bd4f7483.js";import{L as h,B}from"./UserMemberProfileWrapper-9593601c.js";import{H as y,a as ee}from"./FormInputView-4c2d301f.js";import{$ as ae,a0 as ne}from"./finance-manager-api-60207d3b.js";import{u as te,n as ce,c as de}from"./StaffMemberConfig-a4319af1.js";import{d as le}from"./dayjs.min-2c4d82f7.js";import{l as _e}from"./localTime-457a5ccd.js";import{u as w,c as se,f as me}from"./AssestsBaseUrl-b3cf1f1b.js";const pe="_settle_card_divgz_1",ue="_settle_card_container_divgz_12",re="_settle_card_text_divgz_23",fe="_settle_paragraph_divgz_36",xe="_sidebarheader_divgz_51",je="_text_divgz_63",ge="_rcv_divgz_71",ve="_history_image_container_divgz_84",l={settle_card:pe,settle_card_container:ue,settle_card_text:re,settle_paragraph:fe,sidebarheader:xe,text:je,rcv:ge,history_image_container:ve},K=({history:e})=>{var v,L,o,z,F,$,P,R,D,E,C,k,H,U,M,O,T,I,V;const{t:_}=w(),p=Q(),m=W(),[s,r]=c.useState(""),[d,i]=c.useState(!1),[S,f]=c.useState(""),{financeReceipt:n,financeReceiptRefetch:j}=ae({rid:s,skip:!s});c.useEffect(()=>{s&&j()},[s,j]),c.useEffect(()=>{n!=null&&n.receipt&&(n!=null&&n.all_remain)&&f(n)},[n]);const N=u=>{u&&(i(G=>!G),r(u),s===u&&f(n))},g=()=>{},t=()=>{var u;(e==null?void 0:e.payment_module_type)==="Admission"||(e==null?void 0:e.payment_module_type)==="Admission Fees"||(e==null?void 0:e.payment_module_type)==="Hostel"||(e==null?void 0:e.payment_module_type)==="Hostel Fees"?N((u=e==null?void 0:e.fee_receipt)==null?void 0:u._id):(e==null||e.payment_module_type,g())};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:l.sidebarheader,style:{gap:"1%"},title:(e==null?void 0:e.payment_module_type)==="Income"?"":"View Receipt",children:[a.jsxs("div",{className:l.history_image_container,style:{width:"50%"},children:[(v=e==null?void 0:e.payment_student)!=null&&v.studentProfilePhoto?a.jsx(A,{to:`/${p.username}/student/profile`,state:{...m.state,studentId:(L=e==null?void 0:e.payment_student)==null?void 0:L._id},children:a.jsx("img",{src:`${J}/${(o=e==null?void 0:e.payment_student)==null?void 0:o.studentProfilePhoto}`,alt:"qr code",style:{width:"60px",height:"60px",borderRadius:"12px"}})}):null,a.jsxs("div",{className:l.text,children:[a.jsx("p",{className:l.rcv,children:_("recived_from")}),a.jsx("h6",{children:e!=null&&e.payment_student?`${(z=e==null?void 0:e.payment_student)==null?void 0:z.studentFirstName} ${(F=e==null?void 0:e.payment_student)==null?void 0:F.studentMiddleName} ${($=e==null?void 0:e.payment_student)==null?void 0:$.studentLastName}`:((P=e==null?void 0:e.payment_by_end_user_id)==null?void 0:P.userLegalName)??(e==null?void 0:e.payment_by_end_user_id_name)}),a.jsxs("p",{className:l.rcv,children:[_("gr_number")," ",((R=e==null?void 0:e.payment_student)==null?void 0:R.studentGRNO)??""]}),a.jsx("p",{className:l.rcv,children:((E=(D=e==null?void 0:e.payment_student)==null?void 0:D.fee_structure)==null?void 0:E.unique_structure_name)??""})]})]}),a.jsxs("div",{className:l.text,style:{width:"27%"},children:[a.jsx("p",{className:l.rcv,style:{width:"100%"},children:_("transaction_id")}),a.jsx("h6",{style:{width:"100%",wordWrap:"break-word"},children:e!=null&&e.razorpay_payment_id?e==null?void 0:e.razorpay_payment_id:(C=e==null?void 0:e.fee_receipt)!=null&&C.fee_utr_reference?(k=e==null?void 0:e.fee_receipt)==null?void 0:k.fee_utr_reference:"N/A"}),a.jsxs("p",{className:l.rcv,style:{width:"100%"},children:[le(e==null?void 0:e.created_at).format("DD MMM YYYY"),", ",_e(e==null?void 0:e.created_at,"LT")]})]}),a.jsxs("div",{className:l.text,style:{width:"20%"},children:[a.jsxs("p",{className:l.rcv,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[_("invoice_no")," ",((H=e==null?void 0:e.fee_receipt)==null?void 0:H.invoice_count)??(e==null?void 0:e.payment_invoice_number)??"N/A",a.jsx("img",{src:`${se}/receipt.svg`,alt:"receipt icon",title:"Download Fees Receipt",onClick:t})]}),a.jsxs("h6",{style:{width:"100%"},children:["Rs. ",e==null?void 0:e.payment_amount]}),a.jsx("p",{className:l.rcv,style:{width:"100%"},children:((U=e.payment_mode)==null?void 0:U.toLowerCase())==="offline"?(M=e==null?void 0:e.fee_receipt)!=null&&M.fee_payment_mode?`${(O=e==null?void 0:e.fee_receipt)==null?void 0:O.fee_payment_mode}`:"Offline - No Receipt":((T=e.payment_mode)==null?void 0:T.toLowerCase())==="online"?(I=e==null?void 0:e.fee_receipt)!=null&&I.fee_payment_mode?`${(V=e==null?void 0:e.fee_receipt)==null?void 0:V.fee_payment_mode}`:"Online - No Receipt":e==null?void 0:e.payment_mode})]})]}),d&&a.jsx(Y,{})]})},ie=({instituteId:e})=>{const{t:_}=w(),[p,m]=c.useState(""),[s,r]=c.useState(1),[d,i]=c.useState(!0),[S,f]=te({skip:p}),{financeAllTransaction:n,financeAllTransactionLoading:j}=ne({data:{uid:e,page:s,limit:10,search:p,filter:""},skip:!e});c.useEffect(()=>{f&&d&&r(t=>t+1)},[f,d]),c.useEffect(()=>{n!=null&&n.length&&ce(n==null?void 0:n.length,i)},[n==null?void 0:n.length]);const N=c.useCallback(de(t=>m(t),500),[]),g=t=>{N(t.target.value)};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:x.fm_search_full,children:a.jsx("section",{className:x.fm_search_full_container,children:a.jsxs("div",{className:x.fm_search_full_container_inner,children:[a.jsx("img",{className:x.fm_search_full_icon,alt:"search icon",src:`${me}/navbar-search.svg`}),a.jsx("input",{type:"text",placeholder:_("search"),onChange:g})]})})}),j&&a.jsx(h,{}),n==null?void 0:n.map((t,v)=>(n==null?void 0:n.length)===v+1?a.jsx("div",{ref:S,children:a.jsx(K,{history:t})},t==null?void 0:t._id):a.jsx(K,{history:t},t==null?void 0:t._id))]})},Ne=c.lazy(()=>q(()=>import("./FinanceSettlement-7611667c.js"),["assets/FinanceSettlement-7611667c.js","assets/index-0b7f6bad.js","assets/index-cd302a39.css","assets/finance-manager-api-60207d3b.js","assets/decrypt-74cd38a1.js","assets/MethodType-30df8d44.js","assets/StaffMemberConfig-a4319af1.js","assets/UserMemberProfileWrapper-9593601c.js","assets/AssestsBaseUrl-b3cf1f1b.js","assets/Modal-07d3eb1d.js","assets/Utils.module-b6acf444.js","assets/Utils-bf34d50f.css","assets/UserMemberProfileWrapper-7c5aafbf.css","assets/StaffMemberConfig-8384788d.css","assets/FinanceManager-a3d1c044.js","assets/UserMemberContentWrapper-bd4f7483.js","assets/UserMemberContentWrapper-951361ab.css","assets/UiTab.module-f6b989ec.js","assets/UiTab-45d9bcb4.css","assets/FormInputView-4c2d301f.js","assets/dayjs.min-2c4d82f7.js","assets/dayjs-5f1ac0fd.css","assets/CreateButton-31b890b3.js","assets/CreateButton-a52028df.css","assets/auth-api-e4fca9d4.js","assets/checkingRequiredField-382733fa.js","assets/PlateformUser.module-0e3694bb.js","assets/PlateformUser-b9d838ae.css","assets/FinanceManager-b066b3ae.css","assets/localTime-457a5ccd.js"])),be=c.lazy(()=>q(()=>import("./FinanceHistory-91df2d8c.js"),["assets/FinanceHistory-91df2d8c.js","assets/index-0b7f6bad.js","assets/index-cd302a39.css","assets/finance-manager-api-60207d3b.js","assets/decrypt-74cd38a1.js","assets/MethodType-30df8d44.js","assets/StaffMemberConfig-a4319af1.js","assets/UserMemberProfileWrapper-9593601c.js","assets/AssestsBaseUrl-b3cf1f1b.js","assets/Modal-07d3eb1d.js","assets/Utils.module-b6acf444.js","assets/Utils-bf34d50f.css","assets/UserMemberProfileWrapper-7c5aafbf.css","assets/StaffMemberConfig-8384788d.css","assets/FinanceManager-a3d1c044.js","assets/UserMemberContentWrapper-bd4f7483.js","assets/UserMemberContentWrapper-951361ab.css","assets/UiTab.module-f6b989ec.js","assets/UiTab-45d9bcb4.css","assets/FormInputView-4c2d301f.js","assets/dayjs.min-2c4d82f7.js","assets/dayjs-5f1ac0fd.css","assets/CreateButton-31b890b3.js","assets/CreateButton-a52028df.css","assets/auth-api-e4fca9d4.js","assets/checkingRequiredField-382733fa.js","assets/PlateformUser.module-0e3694bb.js","assets/PlateformUser-b9d838ae.css","assets/FinanceManager-b066b3ae.css","assets/localTime-457a5ccd.js"])),we=[{label:"receipts",id:"receipt",urlKey:""},{label:"payments",id:"payment",urlKey:"&n=payment"},{label:"settlement_history",id:"settlement",urlKey:"&n=settlement"}],Se=({fid:e,instituteId:_})=>{const{t:p}=w(),[m]=X(),s=W(),r=Q();return a.jsxs(Z,{children:[a.jsx(b,{children:a.jsx("div",{className:x.fm_header_container,children:a.jsx("h6",{children:p("transaction_history")})})}),a.jsx(B,{}),a.jsxs(b,{customStyle:{paddingTop:"0"},children:[a.jsx(y,{children:we.map(d=>a.jsx(ee,{tab:d,isLink:!0,isActive:d.id==="receipt"&&!m.get("n")?!0:m.get("n")===d.id,parentState:s.state,url:`/${r.username}/member/staff/finance?type=history${d.urlKey}`},d==null?void 0:d.id))}),a.jsx(B,{customStyleBorder:{marginTop:"0"}})]}),a.jsx(b,{customStyle:{paddingTop:"0"},children:a.jsx(c.Suspense,{fallback:a.jsx(Y,{}),children:m.get("n")==="payment"?a.jsx(be,{instituteId:_}):m.get("n")==="settlement"?a.jsx(Ne,{instituteId:_}):a.jsx(ie,{instituteId:_})})})]})},ke=Object.freeze(Object.defineProperty({__proto__:null,default:Se},Symbol.toStringTag,{value:"Module"}));export{ke as T,l as s};
