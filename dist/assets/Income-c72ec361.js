import{r as h,j as e,Q as W}from"./index-0b7f6bad.js";import{U as D,s as b}from"./FinanceManager-a3d1c044.js";import{u as P,n as w,c as R}from"./StaffMemberConfig-a4319af1.js";import{U as S}from"./UserMemberContentWrapper-bd4f7483.js";import{u as y,c as V,f as $}from"./AssestsBaseUrl-b3cf1f1b.js";import{B as L,L as q}from"./UserMemberProfileWrapper-9593601c.js";import{O as Q,P as O,Q as H,R as z}from"./finance-manager-api-60207d3b.js";import{s as n}from"./Income.module-200dd9e8.js";import{d as Y,F as G}from"./dayjs.min-2c4d82f7.js";import{M as E}from"./Modal-07d3eb1d.js";import{F as I}from"./FormInputView-4c2d301f.js";import{F as J}from"./FormFileView-f6180f69.js";import{A as K}from"./AddButton-ecdbc6c8.js";import{F as X}from"./FormFile-0a7c16e8.js";import{T as Z,a as ee}from"./TileCard-bbe5b4e2.js";import{F as se,P as re}from"./PlateformUser-368ac16c.js";import{F as te}from"./FormTextarea-dd65b7be.js";import{C as oe}from"./CreateButton-31b890b3.js";import{r as ae,e as ne}from"./checkingRequiredField-382733fa.js";import{t as ce}from"./transaction_constant-ad8d613b.js";import"./UiTab.module-f6b989ec.js";import"./auth-api-e4fca9d4.js";import"./MethodType-30df8d44.js";import"./PlateformUser.module-0e3694bb.js";import"./decrypt-74cd38a1.js";import"./Utils.module-b6acf444.js";const le=({fid:r})=>{var s,i,d,p;const{t:c}=y(),{financeIncomeBalance:t}=Q({fid:r,skip:!r});return e.jsxs("div",{className:n.right,children:[e.jsxs("div",{className:n.rightHead,style:{"--bg-expense-color":"#20b038"},children:[e.jsx("h6",{children:c("total_income")}),e.jsxs("h6",{children:[c("rs"),((s=t==null?void 0:t.incomeBalance)==null?void 0:s.financeIncomeCashBalance)+((i=t==null?void 0:t.incomeBalance)==null?void 0:i.financeIncomeBankBalance)]})]}),e.jsxs("div",{className:n.rightBody,children:[e.jsxs("h6",{children:[" ",c("by_cash")," : ",c("rs"),(d=t==null?void 0:t.incomeBalance)==null?void 0:d.financeIncomeCashBalance]}),e.jsxs("h6",{children:[" ",c("by_bank")," : ",c("rs"),(p=t==null?void 0:t.incomeBalance)==null?void 0:p.financeIncomeBankBalance]})]})]})},me=h.memo(le),B=({income:r,setIncomeId:c})=>{var i;const{t}=y(),s=()=>{c(r==null?void 0:r._id)};return e.jsxs("div",{onClick:s,className:n.card_container,children:[e.jsxs("h6",{className:n.invoice_number,children:[t("invoice_no")," "," : "," ",r==null?void 0:r.invoice_number]}),e.jsxs("div",{className:n.sidebarheader,children:[e.jsxs("div",{className:n.text,children:[e.jsx("p",{className:n.rcv,children:t("recived_from")}),e.jsx("h6",{children:r!=null&&r.incomeFrom?r==null?void 0:r.incomeFrom:(i=r==null?void 0:r.incomeFromUser)==null?void 0:i.userLegalName}),e.jsx("p",{className:n.rcv,children:Y(r==null?void 0:r.createdAt).format("MMMM D, YYYY")})]}),e.jsxs("div",{className:n.text,children:[e.jsx("p",{className:n.rcv1}),e.jsxs("h6",{children:[t("rs")," ",r==null?void 0:r.incomeAmount]}),e.jsx("p",{className:n.rcv,children:r==null?void 0:r.incomeAccount})]})]})]})},ie=({onClose:r,incomeId:c})=>{var i,d,p,g,x,_,j,u,F,v;const{t}=y(),{financeIncomeDetail:s}=O({incomeId:c,skip:!c});return e.jsx(E,{onClose:r,children:e.jsxs("div",{className:n.income_detail,children:[e.jsxs("div",{className:n.detailTop,children:[e.jsx("div",{className:n.detailTopMid,children:e.jsx("h6",{children:(i=s==null?void 0:s.oneIncome)!=null&&i.incomeFrom?(d=s==null?void 0:s.oneIncome)==null?void 0:d.incomeFrom:(g=(p=s==null?void 0:s.oneIncome)==null?void 0:p.incomeFromUser)==null?void 0:g.userLegalName})}),e.jsx("div",{className:n.detailTopMid,children:e.jsxs("h6",{children:["Rs. ",(x=s==null?void 0:s.oneIncome)==null?void 0:x.incomeAmount]})})]}),e.jsxs(S,{children:[e.jsx(I,{label:`${t("transaction_mode")}: `,value:(_=s==null?void 0:s.oneIncome)==null?void 0:_.incomeAccount,customFormInput:{fontWeight:"500"}}),e.jsx(I,{label:`${t("description")}: `,value:(j=s==null?void 0:s.oneIncome)==null?void 0:j.incomeDesc,customFormInput:{fontWeight:"500"}}),e.jsx(I,{label:`${t("day_date")}: `,value:Y((u=s==null?void 0:s.oneIncome)==null?void 0:u.createdAt).format("MMMM D, YYYY"),customFormInput:{fontWeight:"500"}}),(F=financeExpenseDetail==null?void 0:financeExpenseDetail.oneIncome)!=null&&F.incomeAck?e.jsx(J,{label:`${t("acknowlegement")}: `,value:{key:(v=s==null?void 0:s.oneIncome)==null?void 0:v.incomeAck},customFormInput:{fontWeight:"500"}}):null]})]})})},de=({onClose:r,fid:c})=>{var a;const{t}=y(),[s,i]=h.useState({incomeAmount:"",incomeFrom:"",incomeDesc:"",incomeAccount:"By Bank"}),[d,p]=h.useState(""),[g,x]=h.useState(!1),[_,j]=h.useState(!1),[u,F]=h.useState(""),[v,l]=h.useState(""),[U]=H(),A=o=>{o.target.name==="incomeAmount"?i(m=>({...m,[o.target.name]:o.target.value})):i(m=>({...m,[o.target.name]:o.target.value}))},M=o=>{i(m=>({...m,incomeAccount:o}))},T=o=>{p(o.target.files[0])},C=()=>{let o=ae(s,["incomeDesc"]);if(ne(o)){if(c){x(f=>!f);const m=new FormData;m.append("incomeAmount",s.incomeAmount),u||m.append("incomeFrom",s.incomeFrom),m.append("incomeDesc",s.incomeDesc),m.append("incomeAccount",s.incomeAccount),m.append("file",d),U({fData:m,fid:c,user_query:u}).then(()=>{x(f=>!f),r()}).catch(()=>{x(f=>!f)})}}else l(o)},k=o=>{F(o==null?void 0:o._id),j(!1),i(m=>({...m,incomeFrom:o==null?void 0:o.userLegalName}))},N=()=>{j(o=>!o)};return e.jsx(e.Fragment,{children:_?e.jsx(re,{onSelectUser:k,selectedId:u,onClose:N}):e.jsx(E,{onClose:r,children:e.jsxs("div",{className:n.modal_container,children:[e.jsx(S,{children:e.jsxs("div",{className:n.modal_container_outer_header,children:[e.jsx("div",{className:n.modal_container_header,children:e.jsx("h6",{children:t("add_income_receipt")})}),e.jsx("img",{src:`${V}/close.svg`,alt:"close icon",onClick:r})]})}),e.jsx(L,{}),e.jsxs(S,{customStyle:{paddingTop:"0"},children:[e.jsx(Z,{label:"select_transaction_mode",children:(a=ce)==null?void 0:a.map(o=>e.jsx(ee,{tile:o,onTile:M,activeTile:s.incomeAccount},o==null?void 0:o.key))}),e.jsx(G,{label:t("amount"),placeholder:t("amount_placeholder"),name:"incomeAmount",value:s.incomeAmount,type:"text",onChange:A,errorShow:v.incomeAmount}),e.jsx(se,{label:t("from"),placeholder:t("from_placeholder"),name:"incomeFrom",value:s.incomeFrom,type:"text",onChange:A,errorShow:v.incomeFrom,iconUrl:`${$}/navbar-search.svg`,searchLabel:"search_and_select",onSearchAction:N}),e.jsx(te,{label:t("description"),placeholder:t("description_placeholder"),name:"incomeDesc",value:s.incomeDesc,type:"text",onChange:A,errorShow:v.incomeDesc}),e.jsx(X,{label:t("acknowlegement_receipt"),name:"acknowlegement_receipt",value:d!=null&&d.name?{name:d==null?void 0:d.name}:"",onChange:T}),e.jsx(oe,{label:"save_receipt",onAction:C})]}),g&&e.jsx(W,{})]})})})},Ee=({fid:r})=>{var k,N;const{t:c}=y(),[t,s]=h.useState(""),[i,d]=h.useState(1),[p,g]=h.useState(!0),[x,_]=P({skip:t}),[j,u]=h.useState(""),[F,v]=h.useState(!1),{financeIncome:l,financeIncomeLoading:U}=z({data:{fid:r,page:i,limit:10,search:t},skip:!r});h.useEffect(()=>{_&&p&&d(a=>a+1)},[_,p]),h.useEffect(()=>{var a;(a=l==null?void 0:l.allIncome)!=null&&a.length&&w(l==null?void 0:l.length,g)},[(k=l==null?void 0:l.allIncome)==null?void 0:k.length,w]);const A=h.useCallback(R(a=>s(a),500),[]),M=a=>{A(a.target.value)},T=()=>{u("")},C=()=>{v(a=>!a)};return e.jsxs(e.Fragment,{children:[e.jsxs(D,{children:[e.jsx(S,{children:e.jsxs("div",{className:b.fm_header_container,children:[e.jsx("h6",{children:c("income_history")}),e.jsx("div",{className:b.fm_search,children:e.jsx("section",{className:b.fm_search_container,children:e.jsxs("div",{className:b.fm_search_container_inner,children:[e.jsx("img",{className:b.fm_search_icon,alt:"search icon",src:`${$}/navbar-search.svg`}),e.jsx("input",{type:"text",placeholder:c("search"),onChange:M})]})})})]})}),e.jsx(L,{}),e.jsxs(S,{customStyle:{paddingTop:"0.2rem"},children:[e.jsxs("div",{className:b.fm_add_button,children:[e.jsx(me,{fid:r}),e.jsx(K,{label:"add_new_income",onAction:C})]}),U&&e.jsx(q,{}),(N=l==null?void 0:l.allIncome)==null?void 0:N.map((a,o)=>{var m;return((m=l==null?void 0:l.allIncome)==null?void 0:m.length)===o+1?e.jsx("div",{ref:x,children:e.jsx(B,{income:a,setIncomeId:u})},a==null?void 0:a._id):e.jsx(B,{income:a,setIncomeId:u},a==null?void 0:a._id)})]})]}),j&&e.jsx(ie,{onClose:T,incomeId:j}),F&&e.jsx(de,{onClose:C,fid:r})]})};export{Ee as default};
